(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    225922,       5385]
NotebookOptionsPosition[    225394,       5364]
NotebookOutlinePosition[    225816,       5380]
CellTagsIndexPosition[    225773,       5377]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Do", " ", "a", " ", "simple", " ", "Method", " ", "of", " ", 
    "Characteristics", " ", "MOC", " ", "demonstation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Many", " ", "thanks", " ", "to", " ", 
       RowBox[{
        RowBox[{"barnhart", "@", "wri"}], ".", "com"}], " ", "for", " ", 
       RowBox[{"LensLab", "'"}], "s", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"inspirations", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}]}], "--"}], "--"}], "-"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"basic", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"definitions", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}]}], "-"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Rays", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"NumberOfRays", "\[Rule]", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DrawSystem", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"PlotType", "\[Rule]", 
     RowBox[{"3", "D"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PolygonalNode", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NodeType", "\[Rule]", " ", "ich"}], ",", " ", 
     RowBox[{"NodeID", "\[Rule]", "Fuel"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FilterOptions", "[", 
     RowBox[{"command_Symbol", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"keywords", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"Options", "[", "command", "]"}]}]}], "}"}], ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"keywords", ",", 
            RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "the", " ", "surfaces", " ", "are", " ", "parametrized", " ", "as", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"y", ",", "z"}], "]"}], ",", "y", ",", "z"}], ")"}]}], "-", 
     "vectors"}], " ", ";", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "surfaces", " ", "can", " ", "be", " ", "rotated", " ", 
      "around", " ", "the", " ", "z"}], "-", "axis"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"fx", ",", " ", "fy", ",", " ", 
    RowBox[{
    "fz", " ", "are", " ", "the", " ", "respective", " ", "coordinate", " ", 
     "projections", " ", "of", " ", "the", " ", "surface", " ", "onto", " ", 
     "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "and", " ", "z", " ", "axis"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"f_", ",", "x_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tx", ",", "tz"}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"theta", " ", "Degree"}], "]"}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"tx", ",", "tz"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"theta", " ", "Degree"}], "]"}], " ", "tx"}], "+", "x"}], 
        "]"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fy", "[", 
    RowBox[{"f_", ",", "y_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tx", ",", "tz"}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"theta", " ", "Degree"}], "]"}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"tx", ",", "tz"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"theta", " ", "Degree"}], "]"}], " ", "tx"}], "+", "y"}], 
        "]"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fz", "[", 
     RowBox[{"f_", ",", "z_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tx", ",", "tz"}], "}"}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"theta", " ", "Degree"}], "]"}], " ", 
           RowBox[{"f", "[", 
            RowBox[{"tx", ",", "tz"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"theta", " ", "Degree"}], "]"}], " ", "tz"}], "+", "z"}], 
         "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InverseTan", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "tempAngle", "}"}], ",", 
      RowBox[{
       RowBox[{"tempAngle", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[NotEqual]", "0"}], ",", 
          RowBox[{"N", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"y", "/", "x"}], "]"}], "]"}], "/", "Degree"}], "]"}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"y", ">", "0"}], ",", "90", ",", 
            RowBox[{"-", "90"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", ">", "0"}], "&&", 
          RowBox[{"y", ">", "0"}]}], ",", "tempAngle", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "<", "0"}], "&&", 
            RowBox[{"y", "<", "0"}]}], ",", 
           RowBox[{
            RowBox[{"-", "180"}], "+", "tempAngle"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "<", "0"}], "&&", 
              RowBox[{"y", "\[GreaterEqual]", "0"}]}], ",", 
             RowBox[{
              RowBox[{"-", "180"}], "-", "tempAngle"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "\[NotEqual]", "0"}], ",", 
               RowBox[{"-", "tempAngle"}], ",", "tempAngle"}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"define", " ", "set", " ", "of", " ", "horizontal", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rays", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
         "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HorizontalParallelRays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xpos_", ",", "ypos_", ",", "zpos_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"rayanglex_", ",", "rayanglez_"}], "}"}], ",", "width_", ",", 
      "options___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rays", ",", "h", ",", "tabs"}], "}"}], ",", 
      RowBox[{
       RowBox[{"rays", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"NumberOfRays", "/.", 
           RowBox[{"{", "options", "}"}]}], "/.", 
          RowBox[{"Options", "[", "Rays", "]"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"rayanglex", " ", "Degree"}], "]"}], "\[NotEqual]", "0"}], 
         ",", 
         RowBox[{"tabs", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"N", "[", 
              RowBox[{"Ray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xpos", "-", 
                   RowBox[{"h", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], " ", ",", 
                  RowBox[{"ypos", "+", 
                   RowBox[{"h", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], " ", ",",
                   "zpos"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"rayanglex", ",", "rayanglez"}], "}"}], ",", 
                "vacuum"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{
               RowBox[{"-", "width"}], "/", 
               RowBox[{"(", "2", ")"}]}], ",", 
              RowBox[{"width", "/", 
               RowBox[{"(", "2", ")"}]}], ",", 
              RowBox[{"width", "/", 
               RowBox[{"(", 
                RowBox[{"(", 
                 RowBox[{"rays", "-", "1"}], ")"}], ")"}]}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"tabs", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"N", "[", 
              RowBox[{"Ray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xpos", "-", 
                   RowBox[{"h", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], " ", ",", 
                  RowBox[{"ypos", "+", 
                   RowBox[{"h", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], " ", ",",
                   "zpos"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"rayanglex", ",", "rayanglez"}], "}"}], ",", 
                "vacuum"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{
               RowBox[{"-", "width"}], "/", 
               RowBox[{"(", "2", ")"}]}], ",", 
              RowBox[{"width", "/", 
               RowBox[{"(", "2", ")"}]}], ",", 
              RowBox[{"width", "/", 
               RowBox[{"(", 
                RowBox[{"rays", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}]}], 
        "]"}], ";", "tabs"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CenteredParallelRays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xposcenter_", ",", "yposcenter_", ",", "zposcenter_"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"rayanglex_", ",", "rayanglez_"}], "}"}], ",", "width_", ",", 
      "leng_", ",", "options___"}], "]"}], ":=", 
    RowBox[{"HorizontalParallelRays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xposcenter", "-", 
         RowBox[{"leng", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"rayanglez", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], ",", 
        RowBox[{"yposcenter", "-", 
         RowBox[{"leng", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"rayanglez", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"rayanglex", " ", "Degree"}], "]"}]}]}], ",", 
        RowBox[{"zposcenter", "-", 
         RowBox[{"leng", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"rayanglez", " ", "Degree"}], "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"rayanglex", ",", "rayanglez"}], "}"}], ",", "width", ",", 
      "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"define", " ", "outer", " ", "boundary", " ", "of", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"system", " ", "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Boundary", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"PlacedBoundary", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "x2", ",", "0"}], "]"}], ",", 
        RowBox[{"fy", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y2", "+", "y1"}], ")"}], "/", "2"}], ",", "0"}], "]"}], 
        ",", 
        RowBox[{"fz", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "+", "x1"}], ")"}], "/", "2"}], ",", "90"}], "]"}], 
        ",", 
        RowBox[{"fy", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "y2", ",", "90"}], "]"}], ",", 
        RowBox[{"fz", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "x1", ",", "0"}], "]"}], ",", 
        RowBox[{"fy", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y2", "+", "y1"}], ")"}], "/", "2"}], ",", "0"}], "]"}], 
        ",", 
        RowBox[{"fz", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "+", "x1"}], ")"}], "/", "2"}], ",", "90"}], "]"}], 
        ",", 
        RowBox[{"fy", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "y1", ",", "90"}], "]"}], ",", 
        RowBox[{"fz", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
      RowBox[{"0", "&"}], ",", 
      RowBox[{"0", "&"}], ",", 
      RowBox[{"0", "&"}], ",", 
      RowBox[{"0", "&"}], ",", "0", ",", "90", ",", "0", ",", "90", ",", 
      RowBox[{"y2", "-", "y1"}], ",", 
      RowBox[{"x2", "-", "x1"}], ",", 
      RowBox[{"y2", "-", "y1"}], ",", 
      RowBox[{"x2", "-", "x1"}], ",", 
      RowBox[{"z2", "-", "z1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"define", " ", "a", " ", "polygon"}], " ", ";", " ", 
    RowBox[{
     RowBox[{
     "fuel", " ", "rods", " ", "are", " ", "simulated", " ", "as", " ", 
      "many"}], "-", 
     RowBox[{"faced", " ", 
      RowBox[{"polygons", " ", "--"}], 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Place", "[", 
     RowBox[{
      RowBox[{"PolygonalNode", "[", 
       RowBox[{"NumberOfSides_", ",", "Diameter_", ",", "Height_"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "thetax_"}], "}"}], ",", "options___"}], 
     "]"}], ":=", 
    RowBox[{"PlacedPolygonalNode", "[", 
     RowBox[{"NumberOfSides", ",", "Diameter", ",", "Height", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "thetax"}], "}"}], ",", "options"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "propagate", " ", "a", " ", "ray", " ", "through", " ", "a", " ", "single",
     " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sourface", " ", "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "for", " ", "every", " ", "ray", " ", "an", " ", "interaction", " ", 
      "with", " ", "every", " ", "surface", " ", "is", " ", "checked"}], ";", 
     " ", 
     RowBox[{
     "if", " ", "there", " ", "is", " ", "a", " ", "hit", " ", "with", " ", 
      "a", " ", "surface", " ", "a", " ", "new", " ", "ray", " ", "is", " ", 
      "created"}]}], ",", " ", "\[IndentingNewLine]", "   ", 
    RowBox[{
    "otherwise", " ", "the", " ", "original", " ", "ray", " ", "is", " ", 
     "returned"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"MainSolve", "::", "elist"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"propagateRay", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "_"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"propagateRay", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", "]"}], ",", "_"}], "}"}], ",", "_"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"propagateRay", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
         "]"}], ",", "index_"}], "}"}], ",", 
      RowBox[{"Surface", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fx_", ",", "fy_", ",", "fz_"}], "}"}], ",", "fraw_", ",", 
        RowBox[{"{", 
         RowBox[{"lensxtheta_", ",", "lensztheta_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width_", ",", "height_"}], "}"}], ",", "indexL_", ",", 
        "indexR_", ",", "componentType_", ",", "surID_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tx", ",", "tz", ",", "txx", ",", "tzz", ",", "tl", ",", "t1", ",", 
        "tl1", ",", "rx2", ",", "ry2", ",", "rz2", ",", "thetax2", ",", 
        "thetaz2", ",", "df", ",", "thetaxsurface", ",", "thetazsurface", ",",
         "ignored", ",", "intersections", ",", "typus"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"componentType", "===", "Absorptive"}], "&&", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"thetax1", "-", "lensxtheta"}], "]"}], "\[Equal]", 
             "90"}]}], ")"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Ray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rx1", ",", "ry1", ",", "rz1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"thetax1", ",", "thetaz1"}], "}"}], ",", "stopped"}], 
              "]"}], ",", "index"}], "}"}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intersections", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tl", ",", "tx", ",", "tz"}], "}"}], "/.", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{"N", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rx1", "+", 
                   RowBox[{"tl", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}]}], "\[Equal]", 
                  RowBox[{"fx", "[", 
                   RowBox[{"tx", ",", "tz"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ry1", "+", 
                   RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}]}], "\[Equal]", 
                  RowBox[{"fy", "[", 
                   RowBox[{"tx", ",", "tz"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"rz1", "+", 
                   RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetaz1", " ", "Degree"}], "]"}]}]}], "\[Equal]", 
                  RowBox[{"fz", "[", 
                   RowBox[{"tx", ",", "tz"}], "]"}]}]}], "}"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"tl", ",", "tx", ",", "tz"}], "}"}]}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"width", "\[Equal]", 
          RowBox[{"Abs", "[", "width", "]"}]}], ",", 
         RowBox[{"intersections", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"intersections", ",", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"tl", ",", "tx", ",", "tz"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", "tx", "]"}], "\[LessEqual]", 
                    RowBox[{"width", "/", "2"}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", "tz", "]"}], "\[LessEqual]", 
                    RowBox[{"height", "/", "2"}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tx", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tl", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tz", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{"tl", ">", "0"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"rx1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fx", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"ry1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fy", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"rz1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetaz1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fz", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}]}]}], "]"}], ",", "#"}], 
              "]"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", "else", "*)"}], ",", 
         RowBox[{"intersections", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"intersections", ",", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"tl", ",", "tx", ",", "tz"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"tx", "^", "2"}], "+", 
                    RowBox[{"tz", "^", "2"}]}], "\[LessEqual]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"width", "/", "2"}], ")"}], "^", "2"}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tx", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tl", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tz", "]"}], "\[Equal]", "0"}], ")"}], 
                  "&&", 
                  RowBox[{"(", 
                   RowBox[{"tl", ">", "0"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"rx1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fx", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"ry1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetax1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fy", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"rz1", "+", 
                    RowBox[{"tl", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"thetaz1", " ", "Degree"}], "]"}]}], "-", 
                    RowBox[{"fz", "[", 
                    RowBox[{"tx", ",", "tz"}], "]"}]}], "]"}], "]"}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], ")"}]}]}], "]"}], ",", "#"}], 
              "]"}], "&"}]}], "]"}]}]}], "]"}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "intersections", "]"}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Ray", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rx1", ",", "ry1", ",", "rz1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"thetax1", ",", "thetaz1"}], "}"}], ",", "rayid"}], 
             "]"}], ",", "index"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tl1", ",", "tx", ",", "tz"}], "}"}], "=", 
        RowBox[{"First", "[", 
         RowBox[{"Sort", "[", "intersections", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rx2", "=", 
        RowBox[{"N", "[", 
         RowBox[{"rx1", "+", 
          RowBox[{"tl1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"thetax1", " ", "Degree"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ry2", "=", 
        RowBox[{"N", "[", 
         RowBox[{"ry1", "+", 
          RowBox[{"tl1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"thetax1", " ", "Degree"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rz2", "=", 
        RowBox[{"N", "[", 
         RowBox[{"rz1", "+", 
          RowBox[{"tl1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"thetaz1", " ", "Degree"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"componentType", "===", "Absorptive"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Ray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"I", ",", "I"}], "}"}]}], "]"}], ",", "index"}], 
             "}"}], "]"}]}], "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{" ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Ray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rx1", "+", "1"}], ",", 
                 RowBox[{"ry1", "+", "1"}], ",", "rz1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"thetax1", ",", "thetaz1"}], "}"}]}], "]"}], ",", 
             "indexR"}], "}"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Ray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"thetax2", ",", "thetaz2"}], "}"}]}], "]"}], ",", 
             "indexR"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"thetax1", ",", "thetaz1"}], "}"}], ",", "surID"}], "]"}],
          ",", "index"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"turn", " ", "components", " ", "into", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"surfaces", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"componentToSurfaces", "[", "Null", "]"}], ":=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"componentToSurfaces", "[", 
     RowBox[{"PlacedBoundary", "[", 
      RowBox[{
      "f1_", ",", "f2_", ",", "f3_", ",", "f4_", ",", "fraw1_", ",", "fraw2_",
        ",", "fraw3_", ",", "fraw4_", ",", "theta1_", ",", "theta2_", ",", 
       "theta3_", ",", "theta4_", ",", "width1_", ",", "width2_", ",", 
       "width3_", ",", "width4_", ",", "height_"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Surface", "[", 
       RowBox[{"f1", ",", "fraw1", ",", 
        RowBox[{"{", 
         RowBox[{"theta1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width1", ",", "height"}], "}"}], ",", 
        RowBox[{"0", "&"}], ",", 
        RowBox[{"1", "&"}], ",", "Absorptive", ",", "vacuum"}], "]"}], ",", 
      RowBox[{"Surface", "[", 
       RowBox[{"f2", ",", "fraw2", ",", 
        RowBox[{"{", 
         RowBox[{"theta2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width2", ",", "height"}], "}"}], ",", 
        RowBox[{"0", "&"}], ",", 
        RowBox[{"1", "&"}], ",", "Absorptive", ",", "vacuum"}], "]"}], ",", 
      RowBox[{"Surface", "[", 
       RowBox[{"f3", ",", "fraw3", ",", 
        RowBox[{"{", 
         RowBox[{"theta3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width3", ",", "height"}], "}"}], ",", 
        RowBox[{"0", "&"}], ",", 
        RowBox[{"1", "&"}], ",", "Absorptive", ",", "vacuum"}], "]"}], ",", 
      RowBox[{"Surface", "[", 
       RowBox[{"f4", ",", "fraw4", ",", 
        RowBox[{"{", 
         RowBox[{"theta4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width4", ",", "height"}], "}"}], ",", 
        RowBox[{"0", "&"}], ",", 
        RowBox[{"1", "&"}], ",", "Absorptive", ",", "vacuum"}], "]"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"componentToSurfaces", "[", 
     RowBox[{"PlacedPolygonalNode", "[", 
      RowBox[{"NumberOfSides_", ",", "Diameter_", ",", "Height_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "thetax_"}], "}"}], ",", "options___"}],
       "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "subwidth", ",", "subtheta", ",", "offsettheta", ",", "sourcex", ",", 
        "sourcey", ",", "sourcez", ",", "newthetax", ",", "unitangle", ",", 
        "x1", ",", "x2", ",", "y1", ",", "y2", ",", "thetaT", ",", "thetaT1", 
        ",", "thetaT2", ",", "xpos", ",", "xposr", ",", "ypos", ",", 
        "PrimeAngle", ",", "typus", ",", "mix"}], "}"}], ",", 
      RowBox[{
       RowBox[{"subwidth", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"Chop", "[", 
          RowBox[{"N", "[", 
           RowBox[{"Diameter", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"Pi", "/", "NumberOfSides"}], "]"}]}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sourcex", ",", "sourcey", ",", "sourcez"}], "}"}], "=", 
        "Source"}], ";", "\[IndentingNewLine]", 
       RowBox[{"unitangle", "=", 
        RowBox[{"N", "[", 
         RowBox[{"360", "/", "NumberOfSides"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"typus", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"NodeID", "/.", 
            RowBox[{"{", "options", "}"}]}], "/.", 
           RowBox[{"Options", "[", "PolygonalNode", "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrimeAngle", "[", "theta_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theta", ">", "180"}], ",", 
          RowBox[{"theta", "-", "360"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"theta", "<", 
             RowBox[{"-", "180"}]}], ",", 
            RowBox[{"theta", "+", "360"}], ",", "theta"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"offsettheta", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"InverseTan", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"sourcey", "-", "y"}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{"sourcex", "-", "x"}], ")"}]}], "]"}], "/", 
             "unitangle"}], "]"}], " ", "unitangle"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newthetax", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          RowBox[{"thetax", "-", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"thetax", "/", "unitangle"}], "]"}], " ", 
            "unitangle"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"x1", ":=", 
        RowBox[{"Diameter", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"thetaT", "-", 
              RowBox[{"unitangle", "/", "2"}]}], ")"}], " ", "Degree"}], 
           "]"}], "/", "2"}]}]}], ";", 
       RowBox[{"y1", ":=", 
        RowBox[{"Diameter", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"thetaT", "-", 
              RowBox[{"unitangle", "/", "2"}]}], ")"}], " ", "Degree"}], 
           "]"}], "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x2", ":=", 
        RowBox[{"Diameter", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"thetaT", "+", 
              RowBox[{"unitangle", "/", "2"}]}], ")"}], " ", "Degree"}], 
           "]"}], "/", "2"}]}]}], ";", 
       RowBox[{"y2", ":=", 
        RowBox[{"Diameter", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"thetaT", "+", 
              RowBox[{"unitangle", "/", "2"}]}], ")"}], " ", "Degree"}], 
           "]"}], "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xpos", ":=", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x2", "+", "x1"}], ")"}], "/", "2"}], "]"}], "]"}], "+", 
         "x"}]}], ";", 
       RowBox[{"xposr", ":=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Chop", "[", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x2", "+", "x1"}], ")"}], "/", "2"}], "]"}], "]"}]}], 
         "+", "x"}]}], ";", 
       RowBox[{"ypos", ":=", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y2", "+", "y1"}], ")"}], "/", "2"}], "]"}], "]"}], "+", 
         "y"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mix", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"thetaT", "=", 
             RowBox[{"PrimeAngle", "[", 
              RowBox[{"newthetax", "+", "offsettheta"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"EvenQ", "[", "NumberOfSides", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Surface", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fx", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "xpos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fy", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "ypos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fz", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"0", "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"thetaT", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"subwidth", ",", "Height"}], "}"}], ",", 
                  RowBox[{"1", "&"}], ",", 
                  RowBox[{"1", "&"}], ",", "Refractive", ",", "typus"}], 
                 "]"}], ",", 
                RowBox[{"Surface", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fx", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "xposr", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fy", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "ypos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fz", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"0", "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"thetaT", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"subwidth", ",", "Height"}], "}"}], ",", 
                  RowBox[{"1", "&"}], ",", 
                  RowBox[{"1", "&"}], ",", "Refractive", ",", "typus"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"Surface", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fx", "[", 
                   RowBox[{
                    RowBox[{"0", "&"}], ",", "xpos", ",", "thetaT"}], "]"}], 
                  ",", 
                  RowBox[{"fy", "[", 
                   RowBox[{
                    RowBox[{"0", "&"}], ",", "ypos", ",", "thetaT"}], "]"}], 
                  ",", 
                  RowBox[{"fz", "[", 
                   RowBox[{
                    RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"0", "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"thetaT", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"subwidth", ",", "Height"}], "}"}], ",", 
                RowBox[{"1", "&"}], ",", 
                RowBox[{"1", "&"}], ",", "Refractive", ",", "typus"}], 
               "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"thetaT1", "=", 
                 RowBox[{"newthetax", "-", "subtheta", "+", "offsettheta"}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"thetaT2", "=", 
                 RowBox[{"newthetax", "+", "subtheta", "+", "offsettheta"}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"thetaT1", "-", "offsettheta"}], "]"}], "<", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"thetaT2", "-", "offsettheta"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"thetaT", "=", 
                    RowBox[{"PrimeAngle", "[", "thetaT1", "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"thetaT2", "=", 
                    RowBox[{"PrimeAngle", "[", "thetaT2", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"thetaT", "=", 
                    RowBox[{"PrimeAngle", "[", "thetaT2", "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"thetaT2", "=", 
                    RowBox[{"PrimeAngle", "[", "thetaT1", "]"}]}]}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"Surface", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fx", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "xpos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fy", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "ypos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fz", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"0", "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"thetaT", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"subwidth", ",", "Height"}], "}"}], ",", 
                  RowBox[{"1", "&"}], ",", 
                  RowBox[{"1", "&"}], ",", "Refractive", ",", "typus"}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"thetaT", "=", "thetaT2"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Surface", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fx", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "xpos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fy", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "ypos", ",", "thetaT"}], "]"}], 
                    ",", 
                    RowBox[{"fz", "[", 
                    RowBox[{
                    RowBox[{"0", "&"}], ",", "0", ",", "0"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"0", "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"thetaT", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"subwidth", ",", "Height"}], "}"}], ",", 
                  RowBox[{"1", "&"}], ",", 
                  RowBox[{"1", "&"}], ",", "Refractive", ",", "typus"}], 
                 "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"subtheta", ",", "unitangle", ",", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"NumberOfSides", "-", "4"}], ")"}], "/", "2"}], 
                  "+", "1.001"}], "]"}], " ", "unitangle"}], ",", 
               "unitangle"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "mix"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"render", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"components", "  ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderComponent", "[", 
     RowBox[{"PlacedBoundary", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f1x_", ",", "f1y_", ",", "f1z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"f2x_", ",", "f2y_", ",", "f2z_"}], "}"}], ",", "f3_", ",", 
       "_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_", ",", 
       "_", ",", "_", ",", "_", ",", "_", ",", "dy_", ",", "dx_", ",", 
       "dz_"}], "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x2", ",", "y2"}], "}"}], ",", 
      RowBox[{
       RowBox[{"x2", "=", 
        RowBox[{"f1x", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", 
       RowBox[{"y2", "=", 
        RowBox[{"f2y", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Hue", "[", "0.8", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x2", "-", "dx"}], ",", 
             RowBox[{"y2", "-", "dy"}], ",", 
             RowBox[{
              RowBox[{"-", "dz"}], "/", "2"}]}], "}"}], "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x2", "-", "dx"}], ",", 
             RowBox[{"y2", "-", "dy"}], ",", 
             RowBox[{
              RowBox[{"+", "dz"}], "/", "2"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x2", "-", "dx"}], ",", 
               RowBox[{"y2", "-", "dy"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", 
               RowBox[{"y2", "-", "dy"}], ",", "0"}], "}"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x2", ",", 
               RowBox[{"y2", "-", "dy"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x2", "-", "dx"}], ",", "y2", ",", "0"}], "}"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x2", "-", "dx"}], ",", 
               RowBox[{"y2", "-", "dy"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x2", "-", "dx"}], ",", "y2", ",", "0"}], "}"}]}], 
            "}"}], "]"}]}], "}"}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"renderComponent", "[", "Null", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"{", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderComponent", "[", 
     RowBox[{"PlacedPolygonalNode", "[", 
      RowBox[{"NumberOfSides_", ",", "Diameter_", ",", "Height_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "thetax_"}], "}"}], ",", "options___"}],
       "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtheta", ",", "topside", ",", "bottomside", ",", "box"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"box", "[", "theta_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "outline", ",", "x1", ",", "y1", ",", "x2", ",", "y2", ",", 
            "ret"}], "}"}], ",", 
          RowBox[{
           RowBox[{"x1", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"Diameter", " ", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"theta", "-", 
                    RowBox[{"180", "/", "NumberOfSides"}]}], ")"}], 
                  "Degree"}], "]"}], "/", "2"}]}], "+", "x"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y1", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"Diameter", " ", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"theta", "-", 
                    RowBox[{"180", "/", "NumberOfSides"}]}], ")"}], 
                  "Degree"}], "]"}], "/", "2"}]}], "+", "y"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"x2", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"Diameter", " ", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"theta", "+", 
                    RowBox[{"180", "/", "NumberOfSides"}]}], ")"}], 
                  "Degree"}], "]"}], "/", "2"}]}], "+", "x"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y2", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"Diameter", " ", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"theta", "+", 
                    RowBox[{"180", "/", "NumberOfSides"}]}], ")"}], 
                  "Degree"}], "]"}], "/", "2"}]}], "+", "y"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"outline", "=", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y1", ",", 
                  RowBox[{
                   RowBox[{"-", "Height"}], "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x2", ",", "y2", ",", 
                  RowBox[{
                   RowBox[{"-", "Height"}], "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x2", ",", "y2", ",", 
                  RowBox[{"Height", "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y1", ",", 
                  RowBox[{"Height", "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y1", ",", 
                  RowBox[{
                   RowBox[{"-", "Height"}], "/", "2"}]}], "}"}]}], "}"}], 
              "]"}], "//", "N"}]}], ";", 
           RowBox[{"typus", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NodeType", "/.", 
                RowBox[{"{", "options", "}"}]}], "/.", 
               RowBox[{"Options", "[", "PolygonalNode", "]"}]}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typus", "\[Equal]", "Moderator"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", "0.7", "]"}], ",", 
                RowBox[{"Polygon", "[", "outline", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0", "]"}], ",", 
                RowBox[{"Line", "[", "outline", "]"}]}], "}"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typus", "\[Equal]", "Fuel"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", 
                RowBox[{"Polygon", "[", "outline", "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0", "]"}], ",", 
                RowBox[{"Line", "[", "outline", "]"}]}], "}"}], "]"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"subtheta", "+", "thetax"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"subtheta", ",", "0", ",", "360", ",", 
              RowBox[{"360", "/", "NumberOfSides"}]}], "}"}]}], "]"}], "}"}], 
         "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renderRay", "[", "rays_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"twoRaysToLine", ",", 
      RowBox[{"Partition", "[", 
       RowBox[{"rays", ",", "2", ",", "1"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"twoRaysToLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"twoRaysToLine", "[", 
    RowBox[{"{", 
     RowBox[{"_", ",", 
      RowBox[{"{", "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"twoRaysToLine", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "_"}], "]"}], 
         ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx2_", ",", "ry2_", ",", "rz2_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"thetax2_", ",", "thetaz2_"}], "}"}], ",", "_"}], "]"}], 
         ",", "_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hue", "[", "0.3", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1", ",", "ry1", ",", "rz1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Hue", "[", "1", "]"}], ",", 
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"do", " ", "the", " ", "ray", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tracing", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                  "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
           "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "the", " ", "main", " ", "ray", " ", 
     "propagation", " ", 
     RowBox[{"machine", ":", " ", 
      RowBox[{
      "the", " ", "function", " ", "\"\<propagateRay\>\"", " ", "is", " ", 
       "acting", " ", "on", " ", "a", " ", "single", " ", "ray", " ", "and", 
       " ", "is", " ", "testing", "\[IndentingNewLine]", "if", " ", "the", 
       " ", "original", " ", "ray", " ", "or", " ", "its", " ", "translated", 
       " ", "ray", " ", "has", " ", "an", " ", "interaction", " ", "with", 
       " ", "any", " ", "surface", " ", "\[IndentingNewLine]", 
       RowBox[{"FoldList", "[", 
        RowBox[{"f", ",", "x", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]}]}]}], 
    "=", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"f", "[", 
       RowBox[{"x", ",", "a"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"x", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", "c"}], 
       "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"x", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", "c"}], 
         "]"}], ",", "d"}], "]"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "need", " ", "to", " ", "order", " ", "the", " ", "surfaces", 
    " ", "so", " ", "that", " ", "the", " ", "nearest", " ", "surfaces", " ", 
    "are", " ", "treated", " ", "first"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abstand", "[", 
     RowBox[{"position_", ",", 
      RowBox[{"Surface", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fx_", ",", "fy_", ",", "fz_"}], "}"}], ",", "fraw_", ",", 
        RowBox[{"{", 
         RowBox[{"lensxtheta_", ",", "lensztheta_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"width_", ",", "height_"}], "}"}], ",", "indexL_", ",", 
        "indexR_", ",", "componentType_", ",", "surID_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ref", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fx", "[", 
           RowBox[{"0", ",", "0"}], "]"}], ",", 
          RowBox[{"fy", "[", 
           RowBox[{"0", ",", "0"}], "]"}], ",", 
          RowBox[{"fz", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"Norm", "[", 
       RowBox[{"position", "-", "ref"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abstand", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "_"}], "]"}], 
        ",", "_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx2_", ",", "ry2_", ",", "rz2_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax2_", ",", "thetaz2_"}], "}"}], ",", "_"}], "]"}], 
        ",", "_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rx1", ",", "ry1", ",", "rz1"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"rx2", ",", "ry2", ",", "rz2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindNearestSurfacePos", "[", 
     RowBox[{"position_", ",", "sure_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
        RowBox[{"pos", "=", "position"}], ",", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", "sure", "]"}]}], ",", "k", ",", "d"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "0"}], ",", 
         RowBox[{"k", "<", "l"}], ",", 
         RowBox[{"k", "++"}], ",", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{"Abstand", "[", 
            RowBox[{"position", ",", " ", 
             RowBox[{"sure", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{"mix", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"mix", ",", "d"}], "]"}]}], ";"}]}], "]"}], ";", 
       RowBox[{
        RowBox[{"Ordering", "[", 
         RowBox[{"mix", ",", "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrderSurfaces", "[", 
     RowBox[{"position_", ",", "sure_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
        RowBox[{"surf", "=", "sure"}], ",", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", "sure", "]"}]}], ",", "j", ",", "k"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "0"}], ",", 
         RowBox[{"k", "<", "l"}], ",", 
         RowBox[{"k", "++"}], ",", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"FindNearestSurfacePos", "[", 
            RowBox[{"position", ",", "surf"}], "]"}]}], ";", 
          RowBox[{"mix", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"mix", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"surf", ",", 
               RowBox[{"{", "j", "}"}]}], "]"}]}], "]"}]}], ";", 
          RowBox[{"surf", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"surf", ",", 
             RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "mix"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"doRay", "[", 
     RowBox[{
      RowBox[{"Ray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"positionx_", ",", "positiony_", ",", "positionz_"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"anglex_", ",", "anglez_"}], "}"}], ",", "id_"}], "]"}], ",",
       "surfaces_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mix", ",", 
        RowBox[{"sure", "=", "surfaces"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"sure", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"OrderSurfaces", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"positionx", ",", "positiony", ",", "positionz"}], "}"}], 
           ",", "sure"}], "]"}], "]"}]}], ";", 
       RowBox[{"mix", "=", 
        RowBox[{"FoldList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"propagateRay", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Ray", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"positionx", ",", "positiony", ",", "positionz"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"anglex", ",", "anglez"}], "}"}], ",", "id"}], "]"}], 
            ",", 
            RowBox[{"1", "&"}]}], "}"}], ",", "sure"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "mix"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"accumulate", " ", "all", " ", "objects"}], ",", " ", 
    RowBox[{
    "propagate", " ", "rays", " ", "and", " ", "request", " ", "3", "D", " ", 
     "plot", " ", "of", " ", 
     RowBox[{
      RowBox[{"everything", " ", "--"}], "--"}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawSystem", "[", 
     RowBox[{"rays_", ",", "components_", ",", "options___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "placedComponents", ",", "placedSurfaces", ",", "placedRays", ",", 
        "plottype"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Source", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ScreenPoints", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"placedComponents", "=", 
        RowBox[{"Flatten", "[", "components", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"placedSurfaces", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"componentToSurfaces", ",", "placedComponents"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"placedRays", "=", 
        RowBox[{"TallyAll", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"doRay", "[", 
             RowBox[{"#", ",", "placedSurfaces"}], "]"}], "&"}], ",", 
           RowBox[{"Flatten", "[", "rays", "]"}]}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"print", " ", "tracked", " ", "rays", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"TallyAll", "[", "placedRays", "]"}], "]"}]}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", "  ", 
       RowBox[{"graphicaloutput", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"renderComponent", ",", "placedComponents"}], "]"}], ",", 
          RowBox[{"Thickness", "[", "0.0005", "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"renderRay", ",", "placedRays"}], "]"}]}], "}"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"(*", "  ", 
        RowBox[{
         RowBox[{"graphicaloutput", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{"renderComponent", ",", "placedComponents"}], "]"}]}], 
           "}"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ShowSystem", "[", "options", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"accumulate", " ", "all", " ", "objects"}], ",", " ", 
    RowBox[{
     RowBox[{"propagate", " ", "rays", " ", "and", " ", "return", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tracks", "  ", "--"}], "--"}], "--"}], "--"}], "--"}], 
         "--"}], "--"}], "--"}]}], "-", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrackSystem", "[", 
     RowBox[{"rays_", ",", "components_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"placedComponents", ",", "placedSurfaces", ",", "placedRays"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Source", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ScreenPoints", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"placedComponents", "=", 
        RowBox[{"Flatten", "[", "components", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"placedSurfaces", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"componentToSurfaces", ",", "placedComponents"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"placedRays", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"doRay", "[", 
            RowBox[{"#", ",", "placedSurfaces"}], "]"}], "&"}], ",", 
          RowBox[{"Flatten", "[", "rays", "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"TallyAll", "[", "placedRays", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "do", " ", "a", " ", "3", "D", " ", "plot", " ", "of", " ", "the", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"system", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowSystem", "[", "options___", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plottype", ",", "c1", ",", "c2", ",", "opts"}], "}"}], ",", 
      RowBox[{
       RowBox[{"plottype", "=", 
        RowBox[{
         RowBox[{"PlotType", "/.", 
          RowBox[{"{", "options", "}"}]}], "/.", 
         RowBox[{"Options", "[", "DrawSystem", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"opts", "=", 
        RowBox[{"FilterOptions", "[", 
         RowBox[{"Graphics3D", ",", "options"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics3D", "[", "graphicaloutput", "]"}], ",", "opts", 
         ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"tally", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MOCs", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetRayCoord", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], "]"}],
       ",", "index_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"rx1", ",", "ry1", ",", "rz1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetRayID", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
        "]"}], ",", "_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "rayid"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TallyMe", "[", "liste_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"Length", " ", "[", "liste", "]"}]}], ",", "r1", ",", "r2", 
        ",", 
        RowBox[{"lis", "=", "liste"}], ",", "l", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"l", "=", "0"}], ",", 
         RowBox[{"l", "<", "k"}], ",", 
         RowBox[{"l", "++"}], ",", 
         RowBox[{
          RowBox[{"r1", "=", 
           RowBox[{"lis", "[", 
            RowBox[{"[", 
             RowBox[{"l", "+", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"l", "+", "1"}]}], ",", 
            RowBox[{"j", "<", "k"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{
             RowBox[{"r2", "=", 
              RowBox[{"lis", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"GetRayCoord", "[", "r1", "]"}], "==", 
                RowBox[{"GetRayCoord", "[", "r2", "]"}]}], ",", 
               RowBox[{
                RowBox[{"lis", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"lis", ",", 
                   RowBox[{"{", "j", "}"}]}], "]"}]}], ";", 
                RowBox[{"k", "=", 
                 RowBox[{"k", "-", "1"}]}], ";", 
                RowBox[{"j", "=", 
                 RowBox[{"j", "-", "1"}]}]}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "lis"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TallyAll", "[", "liste_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"Length", " ", "[", "liste", "]"}]}], ",", 
        RowBox[{"lis", "=", "liste"}], ",", "r1", ",", "l"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"l", "=", "0"}], ",", 
         RowBox[{"l", "<", "k"}], ",", 
         RowBox[{"l", "++"}], ",", 
         RowBox[{
          RowBox[{"r1", "=", 
           RowBox[{"TallyMe", "[", 
            RowBox[{"lis", "[", 
             RowBox[{"[", 
              RowBox[{"l", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
          RowBox[{"lis", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"lis", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l", "+", "1"}], ")"}], "\[Rule]", "r1"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "lis"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "calculate", " ", "angular", " ", "flux", " ", "in", " ", "regions", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MOCs", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "as", " ", "an", " ", "example", " ", "we", " ", "take", " ", "a", " ", 
      "1"}], "-", "energy", "-", 
     RowBox[{"group", " ", "structure"}]}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "store", " ", "average", " ", "flux", " ", "in", " ", "the", " ", 
     "following", " ", "table", " ", "for", " ", "moderator", " ", "IDm1"}], 
    ",", " ", 
    RowBox[{
    "fuel", " ", "region", " ", "1", " ", "IDf1", " ", "and", " ", "fuel", 
     " ", "region", " ", "2", " ", "IDf2"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GlobalAverageFluxStore", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"4", "\[Pi]"}], ",", 
      RowBox[{"4", "\[Pi]"}], ",", 
      RowBox[{"4", "\[Pi]"}]}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"0", "th", " ", "order", " ", "guess"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "store", " ", "angular", " ", "flux", " ", "in", " ", "the", " ", 
      "following", " ", "table", " ", "for", " ", "moderator", " ", "IDm1"}], 
     ",", " ", 
     RowBox[{
      RowBox[{
      "fuel", " ", "region", " ", "1", " ", "IDf1", " ", "and", " ", "fuel", 
       " ", "region", " ", "2", " ", "IDf2"}], ";", " ", 
      "\[IndentingNewLine]", "   ", 
      RowBox[{
      "we", " ", "will", " ", "consider", " ", "8", " ", "distinct", " ", 
       "directions", " ", "therefore", " ", "every", " ", "region", " ", 
       "has", " ", "8", " ", "inital", " ", "entries"}], ";", 
      "\[IndentingNewLine]", "   ", 
      RowBox[{
      "each", " ", "direction", " ", "has", " ", "unit", " ", "weight"}]}]}], 
    " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"GlobalAngularFluxStore", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}], ",", 
        RowBox[{"1", "/", "8"}]}], "}"}]}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"0", "th", " ", "order", " ", "guess"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetTotalXS", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
        "]"}], ",", "_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XS", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "vacuum"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDm1"}], ",", 
         RowBox[{"XS", "=", "0.049"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf1"}], ",", 
         RowBox[{"XS", "=", "0.026"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf2"}], ",", 
         RowBox[{"XS", "=", "0.026"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "XS"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetScatterXS", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
        "]"}], ",", "_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XS", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "vacuum"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDm1"}], ",", 
         RowBox[{"XS", "=", "0.045"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf1"}], ",", 
         RowBox[{"XS", "=", "0.005"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf2"}], ",", 
         RowBox[{"XS", "=", "0.005"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "XS"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetnuBarXS", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
        "]"}], ",", "_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XS", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "vacuum"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDm1"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf1"}], ",", 
         RowBox[{"XS", "=", "0.07"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf2"}], ",", 
         RowBox[{"XS", "=", "0.07"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "XS"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetFlux", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
        "]"}], ",", "_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XS", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "vacuum"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDm1"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{"GlobalAverageFluxStore", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf1"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{"GlobalAverageFluxStore", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf2"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{"GlobalAverageFluxStore", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "XS"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAngularFlux", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid_"}], 
         "]"}], ",", "_"}], "}"}], ",", "direct_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XS", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "vacuum"}], ",", 
         RowBox[{"XS", "=", "0.0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDm1"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{
           RowBox[{"GlobalAngularFluxStore", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "direct", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf1"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{
           RowBox[{"GlobalAngularFluxStore", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "direct", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid", "===", "IDf2"}], ",", 
         RowBox[{"XS", "=", 
          RowBox[{
           RowBox[{"GlobalAngularFluxStore", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "direct", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "XS"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CheckInside", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx1_", ",", "ry1_", ",", "rz1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax1_", ",", "thetaz1_"}], "}"}], ",", "rayid1_"}], 
         "]"}], ",", "_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rx2_", ",", "ry2_", ",", "rz2_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"thetax2_", ",", "thetaz2_"}], "}"}], ",", "rayid2_"}], 
         "]"}], ",", "_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wo", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid1", "\[Equal]", "rayid2"}], ",", 
         RowBox[{"wo", "=", "2"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid1", "===", "vacuum"}], ",", 
         RowBox[{"wo", "=", "1"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rayid2", "===", "vacuum"}], ",", 
         RowBox[{"wo", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "given", " ", "the", " ", "combination", " ", "of", " ", "material", 
          " ", "IDs", " ", "from", " ", "ray1", " ", "and", " ", "ray2", " ", 
          "we", " ", "have", " ", "to", " ", "tell", " ", "the", " ", "code", 
          " ", "within", " ", "which", " ", "region", " ", "the", " ", 
          "track", " ", "is", " ", "moving"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "entering"}], " ", "or", " ", 
          "leaving", " ", "the", " ", "material", " ", "region", " ", "of", 
          " ", "ray", " ", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rayid1", "===", "IDm1"}], " ", "&&", " ", 
          RowBox[{"rayid2", "\[Equal]", "IDf1"}]}], ",", 
         RowBox[{"wo", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rayid2", "===", "IDm1"}], " ", "&&", " ", 
          RowBox[{"rayid1", "\[Equal]", "IDf1"}]}], ",", 
         RowBox[{"wo", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rayid1", "===", "IDf1"}], " ", "&&", " ", 
          RowBox[{"rayid2", "\[Equal]", "IDf2"}]}], ",", 
         RowBox[{"wo", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rayid2", "===", "IDf1"}], " ", "&&", " ", 
          RowBox[{"rayid1", "\[Equal]", "IDf2"}]}], ",", 
         RowBox[{"wo", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "wo"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntegrateAngularFlux", "[", 
     RowBox[{"track_", ",", "direct_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
        RowBox[{"segments", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"track", ",", "2", ",", "1"}], "]"}]}], ",", "l", ",", 
        "sourceQ", ",", "sourceF", ",", "d", ",", "Xst", ",", "phi", ",", 
        "phi0", ",", "phi1", ",", "phiAve", ",", "ray1", ",", "ray2", ",", 
        "wo"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", "segments", "]"}], ";"}], " ", "*)"}], " ", 
      RowBox[{
       RowBox[{"l", "=", 
        RowBox[{"Length", "[", "segments", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "0"}], ",", 
         RowBox[{"k", "<", "l"}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ray1", "=", 
           RowBox[{
            RowBox[{"segments", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"ray2", "=", 
           RowBox[{
            RowBox[{"segments", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"wo", "=", 
           RowBox[{"CheckInside", "[", 
            RowBox[{"ray1", ",", "ray2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"wo", ">", "0"}], ",", 
            RowBox[{
             RowBox[{"Xst", "=", 
              RowBox[{"GetTotalXS", "[", "ray1", "]"}]}], ";", 
             RowBox[{"phi", "=", 
              RowBox[{"GetFlux", "[", "ray1", "]"}]}], ";", 
             RowBox[{"sourceQ", "=", 
              RowBox[{"phi", "*", 
               RowBox[{
                RowBox[{"GetScatterXS", "[", "ray1", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "\[Pi]"}], ")"}]}]}]}], ";", 
             RowBox[{"sourceF", "=", 
              RowBox[{"phi", "*", 
               RowBox[{
                RowBox[{"GetnuBarXS", "[", "ray1", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "\[Pi]"}], ")"}]}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Xst", "=", 
              RowBox[{"GetTotalXS", "[", "ray2", "]"}]}], ";", 
             RowBox[{"phi", "=", 
              RowBox[{"GetFlux", "[", "ray2", "]"}]}], ";", 
             RowBox[{"sourceQ", "=", 
              RowBox[{"phi", "*", 
               RowBox[{
                RowBox[{"GetScatterXS", "[", "ray2", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "\[Pi]"}], ")"}]}]}]}], ";", 
             RowBox[{"sourceF", "=", 
              RowBox[{"phi", "*", 
               RowBox[{
                RowBox[{"GetnuBarXS", "[", "ray2", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "\[Pi]"}], ")"}]}]}]}]}]}], " ", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "when", " ", "we", " ", "start", " ", "in", " ", "vacuum", " ", 
            "or", " ", "do", " ", "the", " ", "first", " ", "crossover", " ", 
            "from", " ", "vacuum", " ", "to", " ", "outer", " ", "boundary", 
            " ", "we", " ", "take", " ", "inital", " ", "\[IndentingNewLine]",
             "condition", " ", "from", " ", "boundary", " ", "conditions", 
            " ", "otherwise", " ", "from", " ", "result", " ", "of", " ", 
            "last", " ", "track", " ", "integral"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"k", "\[Equal]", "0"}], " ", "||", " ", 
             RowBox[{"k", "\[Equal]", "1"}]}], ",", 
            RowBox[{"phi0", "=", 
             RowBox[{"GetAngularFlux", "[", 
              RowBox[{"ray1", ",", "direct"}], "]"}]}], ",", 
            RowBox[{"phi0", "=", 
             RowBox[{
              RowBox[{"mix", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"d", "=", 
           RowBox[{"Abstand", "[", 
            RowBox[{"ray1", ",", "ray2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"phi1", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Xst", ">", "0"}], ",", 
             RowBox[{
              RowBox[{"phi0", "*", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "Xst"}], "*", "d"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "Xst"}], "*", "d"}], "]"}]}], ")"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sourceQ", "+", "sourceF"}], ")"}], "/", 
                RowBox[{"(", "Xst", ")"}]}]}]}], ",", 
             RowBox[{"phi0", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "Xst"}], "*", "d"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"phiAve", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Xst", ">", "0"}], ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"phi0", "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "Xst"}], "*", "x"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "Xst"}], "*", "x"}], "]"}]}], ")"}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"sourceQ", "+", "sourceF"}], ")"}], "/", 
                  RowBox[{"(", "Xst", ")"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "d"}], "}"}]}], "]"}], ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"phi0", "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "Xst"}], "*", "x"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "d"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mix", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"mix", ",", 
             RowBox[{"{", 
              RowBox[{"phi0", ",", "phi1", ",", "phiAve", ",", "d"}], "}"}]}],
             "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "mix"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"visualize", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MOCs", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"DrawSystem", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"CenteredParallelRays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"45", ",", " ", "0"}], "}"}], ",", " ", "100", ",", "90", ",", 
      RowBox[{"NumberOfRays", "\[Rule]", "10"}]}], "]"}], " ", "\n", "\t", 
    "}"}], ",", "\n", "\t", 
   RowBox[{"{", " ", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"Place", "[", 
      RowBox[{
       RowBox[{"PolygonalNode", "[", 
        RowBox[{"4", ",", "100", ",", "100"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NodeType", "\[Rule]", "Moderator"}], ",", 
         RowBox[{"NodeID", "\[Rule]", " ", "IDm1"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"Place", "[", 
      RowBox[{
       RowBox[{"PolygonalNode", "[", 
        RowBox[{"20", ",", "50", ",", "100"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NodeType", "\[Rule]", " ", "Fuel"}], ",", 
         RowBox[{"NodeID", "\[Rule]", " ", "IDf1"}]}], "}"}]}], "]"}], " ", 
     ",", " ", 
     RowBox[{"Place", "[", 
      RowBox[{
       RowBox[{"PolygonalNode", "[", 
        RowBox[{"20", ",", "30", ",", "100"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NodeType", "\[Rule]", " ", "Fuel"}], ",", 
         RowBox[{"NodeID", "->", "IDf2"}]}], "}"}]}], "]"}], " ", ",", "\n", 
     "\t\t", 
     RowBox[{"Boundary", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "100"}], ",", 
         RowBox[{"-", "100"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"200", ",", "100", ",", "100"}], "}"}]}], "]"}]}], " ", "\n", 
    "\t", "}"}], ",", 
   RowBox[{"PlotType", "\[Rule]", 
    RowBox[{"3", "D"}]}]}], "\n", "]"}]}], "Input",
 CellChangeTimes->{
  3.5205796863234463`*^9, 3.5205797431542463`*^9, {3.520579789345846*^9, 
   3.520579793339446*^9}, {3.5205798259278464`*^9, 3.5205798358494463`*^9}, {
   3.5205799083894463`*^9, 3.5205799484502463`*^9}, 3.5205799896030464`*^9, {
   3.5205800723298464`*^9, 3.5205800729538465`*^9}, {3.5205801210174465`*^9, 
   3.5205801264930463`*^9}, {3.5205807304158463`*^9, 
   3.5205807354390464`*^9}, {3.5205811663110466`*^9, 
   3.5205811926438465`*^9}, {3.5205816827178464`*^9, 
   3.5205816835914464`*^9}, {3.5205817361946464`*^9, 
   3.5205817372242465`*^9}, {3.5205818093586464`*^9, 
   3.5205818877174463`*^9}, {3.5205819648126464`*^9, 
   3.5205819679794464`*^9}, {3.5205820256838465`*^9, 
   3.5205820353090467`*^9}, {3.520582075650646*^9, 3.5205820901430464`*^9}, {
   3.5205821664894466`*^9, 3.520582251649846*^9}, {3.5205823251102467`*^9, 
   3.5205823401174464`*^9}, {3.5205823826430464`*^9, 
   3.5205825180042467`*^9}, {3.5205825589698467`*^9, 
   3.5205826336314464`*^9}, {3.5205831310062466`*^9, 
   3.5205831409746466`*^9}, {3.5205831796314464`*^9, 
   3.5205831919398465`*^9}, {3.5205833226678467`*^9, 
   3.5205833371290464`*^9}, {3.5205833750994463`*^9, 3.520583418529846*^9}, {
   3.5205835686174464`*^9, 3.5205836999226465`*^9}, {3.520583766690646*^9, 
   3.5205837757386465`*^9}, {3.5205862749210463`*^9, 
   3.5205862987578464`*^9}, {3.5205864442902465`*^9, 
   3.5205864773622465`*^9}, {3.5205866033010464`*^9, 
   3.5205866311314464`*^9}, {3.5205867001614466`*^9, 
   3.5205867044358463`*^9}, {3.5205867413922462`*^9, 
   3.5205867558222466`*^9}, {3.5205868182378464`*^9, 
   3.5205870211158466`*^9}, {3.5205870689298463`*^9, 
   3.5205870953406467`*^9}, {3.5205871404246464`*^9, 
   3.5205872570658464`*^9}, {3.5205872939754467`*^9, 3.520587308779846*^9}, {
   3.5205878145162463`*^9, 3.5205878769474463`*^9}, {3.5205905651560464`*^9, 
   3.5205906080716467`*^9}, {3.5205906395836463`*^9, 
   3.5205906399112463`*^9}, {3.5205909503356466`*^9, 
   3.5205909959344463`*^9}, {3.5205910284760466`*^9, 3.520591070424446*^9}, {
   3.5205912475780463`*^9, 3.520591357542446*^9}, {3.520591516896446*^9, 
   3.5205915793432465`*^9}, {3.5205919715896463`*^9, 
   3.5205919754116464`*^9}, {3.5205925741708465`*^9, 
   3.5205926210644464`*^9}, {3.5205929727196465`*^9, 3.520592988990446*^9}, {
   3.5205932263756466`*^9, 3.5205932506960464`*^9}, {3.5205937587880464`*^9, 
   3.5205937905028467`*^9}, {3.5205938672548466`*^9, 3.520593906145646*^9}, {
   3.5205939466276464`*^9, 3.5205940252204466`*^9}, {3.5205940577308464`*^9, 
   3.5205940945000467`*^9}, 3.5205941306296463`*^9, {3.520594173623246*^9, 
   3.5205942140116463`*^9}, {3.5205942636664467`*^9, 
   3.5205943116832466`*^9}, {3.5205945200992465`*^9, 
   3.5205947114488463`*^9}, {3.5205947560336466`*^9, 
   3.5205948130984464`*^9}, {3.5205948813328466`*^9, 
   3.5205948835012465`*^9}, {3.5205949338580465`*^9, 
   3.5205949408936462`*^9}, {3.5205949808764467`*^9, 
   3.5205949902520466`*^9}, {3.5205951789226465`*^9, 
   3.5205952355706463`*^9}, {3.5205953640496464`*^9, 3.5205953719706464`*^9}, 
   3.5205954651086464`*^9, {3.5205955732406464`*^9, 3.520595654525646*^9}, {
   3.5205956920216465`*^9, 3.5205956954716463`*^9}, {3.520596310447646*^9, 
   3.5205964727946463`*^9}, {3.5205965879726467`*^9, 
   3.5205966362666464`*^9}, {3.5205966847716465`*^9, 
   3.5205967676926465`*^9}, {3.520597008178646*^9, 3.5205970096896467`*^9}, {
   3.5205973950816464`*^9, 3.5205974492356462`*^9}, {3.520597871829646*^9, 
   3.5205978968806467`*^9}, {3.5205980996066465`*^9, 
   3.5205981774066467`*^9}, {3.5205982093336463`*^9, 
   3.5205982573246465`*^9}, {3.520598420447646*^9, 3.5205985980026464`*^9}, {
   3.520598670593646*^9, 3.5205986740126467`*^9}, {3.5205987220666466`*^9, 
   3.5205987456146464`*^9}, {3.5205988085076466`*^9, 
   3.5205989793456464`*^9}, {3.5205990606256466`*^9, 
   3.5205991057346463`*^9}, {3.5205991972536464`*^9, 
   3.5205992033686466`*^9}, {3.5205992500926466`*^9, 
   3.5205992824306464`*^9}, {3.5206007605380464`*^9, 
   3.5206007962464466`*^9}, {3.520600871079646*^9, 3.5206009146972466`*^9}, {
   3.5206011255780463`*^9, 3.5206012415640464`*^9}, {3.5206013240412464`*^9, 
   3.5206013771124463`*^9}, {3.5206014195132465`*^9, 3.520601421806446*^9}, 
   3.5206014787464466`*^9, 3.5206015702248464`*^9, {3.5206016323284464`*^9, 
   3.5206016765388465`*^9}, {3.5206018438020463`*^9, 
   3.5206018649868464`*^9}, {3.5206018968576465`*^9, 3.5206019414268465`*^9}, 
   3.5206020548544464`*^9, {3.5206020855864463`*^9, 3.5206021710900464`*^9}, {
   3.5206022048796463`*^9, 3.5206023681804466`*^9}, {3.5206024194576464`*^9, 
   3.5206024544952464`*^9}, {3.5206025589528465`*^9, 
   3.5206026370308466`*^9}, {3.5206026960612464`*^9, 3.5206027555440464`*^9}, 
   3.5206028011896467`*^9, {3.5206028906712465`*^9, 3.5206029013884463`*^9}, {
   3.5206033288908463`*^9, 3.5206033963452463`*^9}, {3.5206034365308466`*^9, 
   3.5206034444088464`*^9}, {3.520603561642846*^9, 3.5206035925932465`*^9}, {
   3.520603642123246*^9, 3.5206036613112464`*^9}, {3.5206037082828465`*^9, 
   3.5206037351928463`*^9}, {3.5206037739432464`*^9, 
   3.5206038311016464`*^9}, {3.5206039001628466`*^9, 
   3.5206039146396465`*^9}, {3.5211259621036463`*^9, 
   3.5211261138386464`*^9}, {3.5211261482886467`*^9, 
   3.5211262335416465`*^9}, {3.521126277532646*^9, 3.5211263798326464`*^9}, 
   3.521126442176646*^9, 3.5211265682936463`*^9, {3.521126601532646*^9, 
   3.5211266060026464`*^9}, {3.521126851822646*^9, 3.5211268783176465`*^9}, 
   3.5211269215026464`*^9, {3.5211270361876464`*^9, 3.5211270944386463`*^9}, {
   3.5211272662466464`*^9, 3.5211273126356463`*^9}, 3.5211273598056464`*^9, {
   3.521127417322646*^9, 3.5211274346736465`*^9}, 3.5211275442386465`*^9, {
   3.5211275828906465`*^9, 3.521127657053646*^9}, {3.5211277797606463`*^9, 
   3.5211277801466465`*^9}, {3.5211279968496466`*^9, 
   3.5211279972146463`*^9}, {3.5211300492396464`*^9, 3.5211301037296467`*^9}, 
   3.5211303005226464`*^9, {3.5211305187956467`*^9, 3.5211305745546465`*^9}, {
   3.5211306430926466`*^9, 3.521130648197646*^9}, {3.5211306893536463`*^9, 
   3.521130717869646*^9}, {3.5211788368524466`*^9, 3.521178837271446*^9}, {
   3.5211791549334464`*^9, 3.521179197089446*^9}, {3.521179538521446*^9, 
   3.5211795459074464`*^9}, 3.521179662950446*^9, {3.5211798044864464`*^9, 
   3.5211798152094464`*^9}, {3.521179870622446*^9, 3.5211799130374465`*^9}, {
   3.5211799496774464`*^9, 3.5211799764324465`*^9}, {3.5211800269334464`*^9, 
   3.5211800557944465`*^9}, {3.521180096839446*^9, 3.5211802404734464`*^9}, {
   3.5211802810854464`*^9, 3.5211803039664464`*^9}, {3.521180485304446*^9, 
   3.5211805675144463`*^9}, {3.5211806249634466`*^9, 
   3.5211807772704463`*^9}, {3.5211824175014467`*^9, 
   3.5211824353334465`*^9}, {3.5211824724274464`*^9, 
   3.5211826192354465`*^9}, {3.5211840642614465`*^9, 3.521184094339446*^9}, {
   3.521184135325446*^9, 3.5211841551574464`*^9}, {3.521184185193446*^9, 
   3.521184195530446*^9}, {3.5211843965314465`*^9, 3.5211845212914467`*^9}, {
   3.5211868243314466`*^9, 3.5211868461254463`*^9}, {3.5211870352904463`*^9, 
   3.5211870706724463`*^9}, {3.5211872201614466`*^9, 
   3.5211872211664467`*^9}, {3.5211872511874466`*^9, 
   3.5211872664464464`*^9}, {3.5211896926834464`*^9, 
   3.5211897150364466`*^9}, {3.5211897912054462`*^9, 3.521189805372446*^9}, {
   3.5211898615404463`*^9, 3.5211898618624463`*^9}, {3.521189936509446*^9, 
   3.5211899368304462`*^9}, {3.5211900182754464`*^9, 
   3.5211900368304462`*^9}, {3.5211901241684465`*^9, 
   3.5211901329604464`*^9}, {3.5211901692604465`*^9, 
   3.5211901801034465`*^9}, {3.521190221113446*^9, 3.5211902462794466`*^9}, 
   3.5211903871944466`*^9, {3.5211904497604465`*^9, 3.5211904771904464`*^9}, {
   3.521190544924446*^9, 3.5211905453024464`*^9}, {3.521190600733446*^9, 
   3.5211906011704464`*^9}, {3.5211906356694465`*^9, 
   3.5211906361124463`*^9}, {3.5211906668644466`*^9, 
   3.5211906682064466`*^9}, {3.5211907523824463`*^9, 
   3.5211907740154467`*^9}, {3.5211908040504465`*^9, 
   3.5211908315794463`*^9}, {3.521190884372446*^9, 3.5211909499064465`*^9}, {
   3.5211910644234467`*^9, 3.5211911193124466`*^9}, {3.5211913315074463`*^9, 
   3.5211913932184467`*^9}, {3.5211914496054463`*^9, 
   3.5211915742344465`*^9}, {3.5211916054354467`*^9, 
   3.5211916353484464`*^9}, {3.521191680738446*^9, 3.521191696561446*^9}, {
   3.5211917592964463`*^9, 3.5211917599454465`*^9}, {3.521191811714446*^9, 
   3.5211918453284464`*^9}, {3.5211919187104464`*^9, 
   3.5211919193954463`*^9}, {3.5211920070404463`*^9, 
   3.5211920206264467`*^9}, {3.5211921813764467`*^9, 
   3.5211921969014463`*^9}, {3.521192310655446*^9, 3.5211923112114463`*^9}, {
   3.5211923549394464`*^9, 3.5211923620574465`*^9}, {3.5211924566914463`*^9, 
   3.5211924954794464`*^9}, {3.5211926335664463`*^9, 
   3.5211926398494463`*^9}, {3.5211926919214463`*^9, 
   3.5211927943194466`*^9}, {3.521192883773446*^9, 3.521192902061446*^9}, {
   3.5211929422214465`*^9, 3.5211929424724464`*^9}, {3.5211931112694464`*^9, 
   3.5211931211054463`*^9}, {3.5211932467904463`*^9, 3.521193248488446*^9}, {
   3.5218647395365477`*^9, 3.5218647437641478`*^9}, {3.521864775931348*^9, 
   3.5218648096429477`*^9}, {3.5218649364553475`*^9, 
   3.5218650635485477`*^9}, {3.521865230109748*^9, 3.5218652962069473`*^9}, {
   3.5218653469537477`*^9, 3.5218653908521476`*^9}, {3.5218662321913476`*^9, 
   3.5218662352021475`*^9}, {3.5218665089665475`*^9, 
   3.5218665101053476`*^9}, {3.5218668518545475`*^9, 
   3.5218668820249476`*^9}, {3.521866932646948*^9, 3.5218669340041475`*^9}, {
   3.5218669869661474`*^9, 3.521867104512148*^9}, {3.521867149627348*^9, 
   3.521867255348548*^9}, {3.5218682288509474`*^9, 3.5218682393341475`*^9}, {
   3.521871190776148*^9, 3.5218711994497476`*^9}, {3.5218712804293475`*^9, 
   3.521871281505748*^9}, {3.5218751131465473`*^9, 3.5218751567953477`*^9}, {
   3.5218763072953477`*^9, 3.5218763084809475`*^9}, {3.5218764405193477`*^9, 
   3.5218764698473473`*^9}, {3.5218765261945477`*^9, 
   3.5218765264753475`*^9}, {3.5218770400585475`*^9, 3.521877040261348*^9}, {
   3.5218772227813473`*^9, 3.5218772665861473`*^9}, {3.521877608600548*^9, 
   3.5218776789097476`*^9}, {3.5218779218641477`*^9, 
   3.5218779368089476`*^9}, {3.5218779746545477`*^9, 
   3.5218779774469476`*^9}, {3.521878036508548*^9, 3.521878037101348*^9}, {
   3.5218780685509477`*^9, 3.5218780721077476`*^9}, {3.5218781453341475`*^9, 
   3.5218781466289473`*^9}, {3.5218782054877477`*^9, 
   3.5218782085765476`*^9}, {3.521878432186948*^9, 3.5218785903553476`*^9}, {
   3.5218786357669477`*^9, 3.5218786433329477`*^9}, {3.5218788383329477`*^9, 
   3.5218789263325477`*^9}, {3.5218790980105476`*^9, 
   3.5218790982289476`*^9}, {3.5218791344989476`*^9, 
   3.5218791592093477`*^9}, {3.521879192187748*^9, 3.5218791979441476`*^9}, {
   3.521879231546548*^9, 3.5218792521073475`*^9}, {3.5218793073313475`*^9, 
   3.5218793194993477`*^9}, {3.521881247472148*^9, 3.5218812680173473`*^9}, {
   3.5218813025713477`*^9, 3.5218813300273476`*^9}, {3.5218814231437473`*^9, 
   3.5218815823729477`*^9}, {3.5218820521825476`*^9, 
   3.5218821780589476`*^9}, {3.5218825756249475`*^9, 
   3.5218825826917477`*^9}, {3.5218827270853477`*^9, 3.521882744884948*^9}, {
   3.521883249342148*^9, 3.5218833022573476`*^9}, {3.5218861673377476`*^9, 
   3.5218862833705473`*^9}, {3.521886546370948*^9, 3.5218865465737476`*^9}, {
   3.521887239790948*^9, 3.5218872471697474`*^9}, {3.521887488408148*^9, 
   3.5218875107941475`*^9}, {3.5218876204153476`*^9, 
   3.5218876260469475`*^9}, {3.5218876665133476`*^9, 
   3.5218876766065474`*^9}, {3.5218877099905477`*^9, 
   3.5218877102401476`*^9}, {3.5218877489281473`*^9, 
   3.5218877806117477`*^9}, {3.5218878277861476`*^9, 
   3.5218878340729475`*^9}, {3.5218879245841475`*^9, 
   3.5218879543177476`*^9}, {3.5218885983949475`*^9, 3.521888602669348*^9}, 
   3.5218886329801474`*^9, {3.5218887542545476`*^9, 3.5218887778729477`*^9}, {
   3.521888827948948*^9, 3.5218888532833476`*^9}, {3.5218888948729477`*^9, 
   3.5218889242945476`*^9}, {3.5218889627329473`*^9, 3.521888964370948*^9}, {
   3.5218890149149475`*^9, 3.5218890221845474`*^9}, {3.5218890555061474`*^9, 
   3.521889057066148*^9}, {3.521889263204548*^9, 3.5218892652949476`*^9}, {
   3.5218895281549473`*^9, 3.5218895870293474`*^9}, {3.5218897284277477`*^9, 
   3.521889740002948*^9}, {3.5218899079057474`*^9, 3.5218899339421473`*^9}, {
   3.5218899933157473`*^9, 3.5218899969817476`*^9}, {3.5218900295077477`*^9, 
   3.5218900300069475`*^9}, {3.5218901103469477`*^9, 
   3.5218901343085475`*^9}, {3.521890317733348*^9, 3.5218903180609474`*^9}, {
   3.5218904761669474`*^9, 3.5218904814553475`*^9}, {3.5218905158065476`*^9, 
   3.521890517974948*^9}, {3.5218906322605476`*^9, 3.521890683210148*^9}, {
   3.5218907547049475`*^9, 3.5218907635813475`*^9}, {3.5218908084625473`*^9, 
   3.5218908876169477`*^9}, {3.5218909191601477`*^9, 
   3.5218909346353474`*^9}, {3.5218910663929477`*^9, 
   3.5218910667205477`*^9}, {3.521891192830948*^9, 3.5218912079473476`*^9}, {
   3.5218915594621477`*^9, 3.5218915664041476`*^9}, {3.5218915989613476`*^9, 
   3.5218916040469475`*^9}, {3.5218916861965475`*^9, 
   3.5218917320137477`*^9}, {3.5218918715557475`*^9, 3.5218918967029476`*^9}, 
   3.5218919365765476`*^9, {3.5218923760285473`*^9, 3.5218923870265474`*^9}, {
   3.5218924198957477`*^9, 3.5218924263385477`*^9}, {3.5218924702369475`*^9, 
   3.5218924883017473`*^9}, {3.5218925325589476`*^9, 
   3.5218925328085475`*^9}, {3.5218930674985476`*^9, 3.521893088917348*^9}, {
   3.5218932809533477`*^9, 3.5218932822793474`*^9}, {3.5218933394845476`*^9, 
   3.5218933435249476`*^9}, {3.5218933938817472`*^9, 
   3.5218934090917473`*^9}, {3.521893440853348*^9, 3.5218934692609477`*^9}, {
   3.5218943834521475`*^9, 3.5218944140749474`*^9}, {3.5218948252285476`*^9, 
   3.5218948530433474`*^9}, {3.5218965765625477`*^9, 
   3.5218965784501476`*^9}, {3.5218966086205473`*^9, 3.521896609462948*^9}, {
   3.5218971255889473`*^9, 3.5218972321369476`*^9}, {3.521897521532548*^9, 
   3.5218975312669477`*^9}, {3.5218979457589474`*^9, 3.5218979718733473`*^9}, 
   3.521898081712948*^9, {3.5218982373073473`*^9, 3.5218982862757473`*^9}, {
   3.5218983965365477`*^9, 3.5218984180333476`*^9}, {3.5218985188093476`*^9, 
   3.5218985635657473`*^9}, {3.5219066925853477`*^9, 
   3.5219066985601473`*^9}, {3.5219071602577477`*^9, 3.521907172347748*^9}, {
   3.521907519494548*^9, 3.5219075533777475`*^9}, {3.5219076274933476`*^9, 
   3.5219076535297475`*^9}, {3.5219077540249476`*^9, 3.521907802166548*^9}, {
   3.521907909135748*^9, 3.5219079485569477`*^9}, {3.5219080034533477`*^9, 
   3.5219080622497473`*^9}, {3.5219084552293477`*^9, 3.521908455634948*^9}, {
   3.5219084987377477`*^9, 3.5219085200005474`*^9}, {3.5219085554125476`*^9, 
   3.5219086239277477`*^9}, {3.5219086777477474`*^9, 
   3.5219086975597477`*^9}, {3.5219089394065475`*^9, 
   3.5219090021653476`*^9}, {3.5219090323045473`*^9, 
   3.5219090482477474`*^9}, {3.5219091596629477`*^9, 
   3.5219091633757477`*^9}, {3.5219092021261473`*^9, 
   3.5219092070713477`*^9}, {3.5219093004997473`*^9, 
   3.5219093287357473`*^9}, {3.5219093745841475`*^9, 
   3.5219094107605476`*^9}, {3.5219095477753477`*^9, 
   3.5219096119381475`*^9}, {3.5219096425141478`*^9, 
   3.5219096439961476`*^9}, {3.521909676568948*^9, 3.5219097221677475`*^9}, {
   3.521909773928548*^9, 3.5219097749269476`*^9}, {3.5219099338753476`*^9, 
   3.5219099341405478`*^9}, {3.5219099883817472`*^9, 
   3.5219100261493473`*^9}, {3.5219101759561477`*^9, 3.521910187281748*^9}, {
   3.5219103325489473`*^9, 3.5219103344989476`*^9}, {3.5219103899569473`*^9, 
   3.5219105531173477`*^9}, {3.5219106022729473`*^9, 3.521910645828148*^9}, 
   3.5219106809437475`*^9, {3.5219107475869474`*^9, 3.5219108139961476`*^9}, {
   3.5219108450089474`*^9, 3.5219108526529474`*^9}, {3.5219109792625475`*^9, 
   3.5219109973273478`*^9}, {3.5219112561625476`*^9, 
   3.5219113248493476`*^9}, {3.521911442847748*^9, 3.5219114496805477`*^9}, {
   3.5219115005989475`*^9, 3.5219115298489475`*^9}, {3.521957393505748*^9, 
   3.521957475296548*^9}, {3.5219575057633476`*^9, 3.5219575486009474`*^9}, {
   3.521957597101348*^9, 3.5219576995309477`*^9}, 3.5219578048933477`*^9, {
   3.5219578406641474`*^9, 3.521957909023348*^9}, {3.521964812382148*^9, 
   3.5219648360941477`*^9}, {3.5219648795245476`*^9, 
   3.5219649473377476`*^9}, {3.5219661085237474`*^9, 
   3.5219661684277477`*^9}, {3.5219662096117477`*^9, 
   3.5219663307769475`*^9}, {3.521966528678548*^9, 3.5219665924045477`*^9}, {
   3.5219669877865477`*^9, 3.521967051824548*^9}, {3.521967341781748*^9, 
   3.521967389595748*^9}, {3.5219677407517476`*^9, 3.5219677467421474`*^9}, {
   3.5219795653177476`*^9, 3.5219795793265476`*^9}, 3.5219798353381476`*^9, {
   3.5219798775829477`*^9, 3.5219798906401477`*^9}, {3.5219800026793475`*^9, 
   3.521980006813348*^9}, 3.5219801384929476`*^9, {3.5219802186613474`*^9, 
   3.5219802269449472`*^9}, {3.5219804701801476`*^9, 
   3.5219804732533474`*^9}, {3.5219805631249475`*^9, 
   3.5219805726409473`*^9}, {3.5219806076161475`*^9, 
   3.5219806115941477`*^9}, {3.521981633612548*^9, 3.521981654282548*^9}, {
   3.5219817074473476`*^9, 3.5219817157153473`*^9}, {3.5219817634513474`*^9, 
   3.5219818697497473`*^9}, {3.5219818999045477`*^9, 
   3.5219819540053473`*^9}, {3.5219819922253475`*^9, 
   3.5219820131605473`*^9}, {3.521982501284548*^9, 3.5219825385217476`*^9}, {
   3.521990618229748*^9, 3.5219906308345475`*^9}, {3.5219909469217477`*^9, 
   3.5219909579353476`*^9}, {3.5219910846853476`*^9, 
   3.5219912471281476`*^9}, {3.5219914070905476`*^9, 
   3.5219915132329473`*^9}, {3.521991562606948*^9, 3.5219915860069475`*^9}, {
   3.5219921023825474`*^9, 3.521992112974948*^9}, {3.5219921732689476`*^9, 
   3.5219922251389475`*^9}, {3.5219922848401475`*^9, 
   3.5219923239493475`*^9}, {3.5219923856941476`*^9, 
   3.5219924128693476`*^9}, {3.5219924724613476`*^9, 
   3.5219925420685472`*^9}, {3.5219930751049476`*^9, 
   3.5219930944957476`*^9}, {3.5219931540721474`*^9, 
   3.5219931554605474`*^9}, {3.5219935194865475`*^9, 
   3.5219935537597475`*^9}, {3.5219937172321477`*^9, 
   3.5219937289321475`*^9}, {3.5219937747025476`*^9, 
   3.5219938065265474`*^9}, {3.5219944159873476`*^9, 
   3.5219944302145476`*^9}, {3.5219944870453477`*^9, 3.521994488043748*^9}, {
   3.5219946127345476`*^9, 3.5219946472261477`*^9}, 3.5219947108117476`*^9, {
   3.5219948329597473`*^9, 3.5219948715073476`*^9}, 3.5219955647869473`*^9, {
   3.5219956117741475`*^9, 3.5219956532701473`*^9}, {3.5219957289457474`*^9, 
   3.521995748632948*^9}, {3.5219962152757473`*^9, 3.521996227833748*^9}, {
   3.521996265523348*^9, 3.5219962720285473`*^9}, {3.5219963339293475`*^9, 
   3.5219963520253477`*^9}, {3.5219964615217476`*^9, 
   3.5219966378017473`*^9}, {3.5219966740561476`*^9, 
   3.5219966743369474`*^9}, {3.521996709000148*^9, 3.5219967112309475`*^9}, {
   3.5219968059385476`*^9, 3.5219968118353477`*^9}, {3.5219968500397477`*^9, 
   3.5219968994293475`*^9}, 3.5219969361829476`*^9, 3.5219969869609475`*^9, {
   3.5219974185973473`*^9, 3.521997423370948*^9}, {3.5219975164717474`*^9, 
   3.5219975167681475`*^9}, {3.521997611538148*^9, 3.5219976118345475`*^9}, {
   3.5219976961057477`*^9, 3.5219976966829476`*^9}, {3.5220429718921475`*^9, 
   3.522043018083748*^9}, {3.5220431750197477`*^9, 3.5220432058609476`*^9}, {
   3.5220432643453474`*^9, 3.522043297339348*^9}, {3.522043358600548*^9, 
   3.5220434265541477`*^9}, {3.5220435358945475`*^9, 
   3.5220435630229473`*^9}, {3.5220437029549475`*^9, 
   3.5220437045305476`*^9}, {3.522044717859748*^9, 3.522044778902548*^9}, {
   3.5220449112061477`*^9, 3.5220449330461473`*^9}, {3.5220451341145477`*^9, 
   3.5220451349881477`*^9}, {3.5220452824393473`*^9, 
   3.5220453061045475`*^9}, {3.522046355126548*^9, 3.5220463598065476`*^9}, 
   3.5220464205685472`*^9, {3.5220465917629476`*^9, 3.522046599828148*^9}, {
   3.522046897491748*^9, 3.522046899816148*^9}, {3.5220474541309476`*^9, 
   3.5220474701677475`*^9}, {3.5220480546529474`*^9, 3.522048084511348*^9}, {
   3.522048164773348*^9, 3.5220482141317472`*^9}, {3.5220483101029477`*^9, 
   3.5220483721753473`*^9}, {3.5220484568677473`*^9, 
   3.5220484885045476`*^9}, {3.5220485664265475`*^9, 
   3.5220486602917476`*^9}, {3.5220487985545473`*^9, 
   3.5220488483029475`*^9}, {3.5220488926537476`*^9, 
   3.5220489777829475`*^9}, {3.522051669172948*^9, 3.5220517200913477`*^9}, {
   3.5220518610997477`*^9, 3.5220518708497477`*^9}, {3.5220520247281475`*^9, 
   3.5220520851625476`*^9}, {3.5220521538961477`*^9, 
   3.5220521552065477`*^9}, {3.522052361719348*^9, 3.5220525048181477`*^9}, {
   3.5220529800565476`*^9, 3.5220530633917475`*^9}, {3.5220531114085474`*^9, 
   3.5220531121417475`*^9}, {3.522053247440548*^9, 3.5220532653805475`*^9}, {
   3.5220545442217474`*^9, 3.5220545848909473`*^9}, {3.5220546161533475`*^9, 
   3.522054635497348*^9}, {3.5220546818605475`*^9, 3.522054689488948*^9}, {
   3.522056811634948*^9, 3.5220568125397477`*^9}, {3.5220580023673477`*^9, 
   3.522058146729748*^9}, {3.5220582120313473`*^9, 3.5220582962245474`*^9}, {
   3.5220585854641476`*^9, 3.5220587475169477`*^9}, {3.5220588283717475`*^9, 
   3.522058841678548*^9}, {3.5220588782917476`*^9, 3.5220589101313477`*^9}, {
   3.5220592117573476`*^9, 3.5220592959505477`*^9}, {3.5220594567397475`*^9, 
   3.5220594936649475`*^9}, {3.5220596208361473`*^9, 
   3.5220596357653475`*^9}, {3.5220597222517476`*^9, 
   3.5220597260269475`*^9}, {3.5220600004309473`*^9, 3.522060002583748*^9}, {
   3.522060333428548*^9, 3.522060366687748*^9}, {3.5220607279993477`*^9, 
   3.522060756687748*^9}, {3.5220608177149477`*^9, 3.5220608184793477`*^9}, {
   3.5220608545621476`*^9, 3.5220608969317474`*^9}, {3.5220618495145473`*^9, 
   3.5220618548185472`*^9}, {3.522062250387748*^9, 3.5220622771885476`*^9}, {
   3.5220623081857476`*^9, 3.5220623085133476`*^9}, {3.5220629377081475`*^9, 
   3.522062942138548*^9}, {3.5220634801825476`*^9, 3.5220634931461477`*^9}, {
   3.5220635854825478`*^9, 3.5220636043117476`*^9}, {3.5220637931965475`*^9, 
   3.522063795255748*^9}, {3.522063842258548*^9, 3.522064057273348*^9}, {
   3.522064087974148*^9, 3.5220641021545477`*^9}, {3.5220642382801476`*^9, 
   3.5220642412597475`*^9}, {3.5220648111277475`*^9, 
   3.5220648179605474`*^9}, {3.5220648740581474`*^9, 
   3.5220648765229473`*^9}, {3.522064932012148*^9, 3.5220649351009474`*^9}, {
   3.522064977704548*^9, 3.5220649826809473`*^9}, {3.5220650587777476`*^9, 
   3.5220650686681476`*^9}, {3.5220651417541475`*^9, 
   3.5220651617689476`*^9}, {3.5220658659841475`*^9, 
   3.5220659009281473`*^9}, {3.5220659876797476`*^9, 
   3.5220660002377477`*^9}, {3.5220661099837475`*^9, 3.5220661149913473`*^9}, 
   3.5220663109273477`*^9, {3.5220663763381476`*^9, 3.5220663818761473`*^9}, {
   3.5220664143865476`*^9, 3.5220664438549476`*^9}, {3.522066524241748*^9, 
   3.5220665251465473`*^9}, {3.5220675181021476`*^9, 
   3.5220676277857475`*^9}, {3.5220676610137477`*^9, 
   3.5220676831969476`*^9}, {3.522067713741748*^9, 3.5220677561425476`*^9}, {
   3.5220681485137477`*^9, 3.522068170977748*^9}, {3.5220684017485476`*^9, 
   3.5220684656461477`*^9}, {3.522068901135748*^9, 3.522068912773348*^9}, {
   3.5220690472609477`*^9, 3.5220691280845475`*^9}, {3.5220693126169477`*^9, 
   3.5220694779613476`*^9}, {3.522069535759348*^9, 3.5220695929177475`*^9}, 
   3.5220699909829473`*^9, {3.5220702595213475`*^9, 3.522070300549348*^9}, {
   3.522070525314148*^9, 3.5220705512413473`*^9}, {3.5220706134385476`*^9, 
   3.5220706163401475`*^9}, 3.5220708653005476`*^9, {3.5220709483081474`*^9, 
   3.5220709494157476`*^9}, {3.5220711035905476`*^9, 
   3.5220711041053476`*^9}, {3.5220711595477476`*^9, 
   3.5220711671605473`*^9}, {3.5220713067025476`*^9, 
   3.5220713137693477`*^9}, {3.522071390068948*^9, 3.5220714163081474`*^9}, {
   3.522073057318948*^9, 3.5220730645417476`*^9}, {3.5220836863789473`*^9, 
   3.5220837171889477`*^9}, {3.522135575928474*^9, 3.522135577441684*^9}, {
   3.522142850691907*^9, 3.5221429860227747`*^9}, {3.5221438406742525`*^9, 
   3.5221438482871017`*^9}, 3.5221460880714593`*^9, {3.5221478675904665`*^9, 
   3.522147914094364*^9}, 3.5221479540462203`*^9, {3.522150448705012*^9, 
   3.522150458221073*^9}, {3.5221505801046543`*^9, 3.5221506430666575`*^9}, {
   3.52215075265736*^9, 3.5221507541237698`*^9}, {3.5221507885687904`*^9, 
   3.522150788989993*^9}, {3.522151702485049*^9, 3.522151719957161*^9}, {
   3.5221519340997334`*^9, 3.5221519441461983`*^9}, {3.5221520983375864`*^9, 
   3.522152136152229*^9}, {3.5221521953546085`*^9, 3.522152210424305*^9}, {
   3.5221549169480543`*^9, 3.5221549172756567`*^9}, {3.522154957991917*^9, 
   3.5221550090354443`*^9}, {3.522155048737699*^9, 3.52215505362053*^9}, {
   3.5221563894726934`*^9, 3.5221563897846956`*^9}, {3.522156478564864*^9, 
   3.5221564788768663`*^9}, 3.5221594670292215`*^9, {3.5221597353977413`*^9, 
   3.5221597484394255`*^9}, {3.5221603205886927`*^9, 
   3.5221604560599613`*^9}, {3.7017002182182035`*^9, 3.7017002682006035`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {Thickness[0.003], {
     {Hue[0.7], 
      Polygon3DBox[{{135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, 35.35533905932738, -50.}, {135.35533905932738`, 
       35.35533905932738, 50.}, {135.35533905932738`, -35.35533905932738, 
       50.}, {135.35533905932738`, -35.35533905932738, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, 35.35533905932738, -50.}, {135.35533905932738`, 
       35.35533905932738, 50.}, {135.35533905932738`, -35.35533905932738, 
       50.}, {135.35533905932738`, -35.35533905932738, -50.}}]}, 
     {Hue[0.7], 
      Polygon3DBox[{{135.35533905932738`, 35.35533905932738, -50.}, {
       64.64466094067262, 35.35533905932738, -50.}, {64.64466094067262, 
       35.35533905932738, 50.}, {135.35533905932738`, 35.35533905932738, 
       50.}, {135.35533905932738`, 35.35533905932738, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{135.35533905932738`, 35.35533905932738, -50.}, {
       64.64466094067262, 35.35533905932738, -50.}, {64.64466094067262, 
       35.35533905932738, 50.}, {135.35533905932738`, 35.35533905932738, 
       50.}, {135.35533905932738`, 35.35533905932738, -50.}}]}, 
     {Hue[0.7], 
      Polygon3DBox[{{64.64466094067262, 35.35533905932738, -50.}, {
       64.64466094067262, -35.35533905932738, -50.}, {
       64.64466094067262, -35.35533905932738, 50.}, {64.64466094067262, 
       35.35533905932738, 50.}, {64.64466094067262, 
       35.35533905932738, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{64.64466094067262, 35.35533905932738, -50.}, {
       64.64466094067262, -35.35533905932738, -50.}, {
       64.64466094067262, -35.35533905932738, 50.}, {64.64466094067262, 
       35.35533905932738, 50.}, {64.64466094067262, 
       35.35533905932738, -50.}}]}, 
     {Hue[0.7], 
      Polygon3DBox[{{64.64466094067262, -35.35533905932738, -50.}, {
       135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, -35.35533905932738, 50.}, {
       64.64466094067262, -35.35533905932738, 50.}, {
       64.64466094067262, -35.35533905932738, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{64.64466094067262, -35.35533905932738, -50.}, {
       135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, -35.35533905932738, 50.}, {
       64.64466094067262, -35.35533905932738, 50.}, {
       64.64466094067262, -35.35533905932738, -50.}}]}, 
     {Hue[0.7], 
      Polygon3DBox[{{135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, 35.35533905932738, -50.}, {135.35533905932738`, 
       35.35533905932738, 50.}, {135.35533905932738`, -35.35533905932738, 
       50.}, {135.35533905932738`, -35.35533905932738, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{135.35533905932738`, -35.35533905932738, -50.}, {
       135.35533905932738`, 35.35533905932738, -50.}, {135.35533905932738`, 
       35.35533905932738, 50.}, {135.35533905932738`, -35.35533905932738, 
       50.}, {135.35533905932738`, -35.35533905932738, -50.}}]}}, {
     {GrayLevel[0.9], 
      Polygon3DBox[{{124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, 3.910861626005772, -50.}, {124.69220851487844`, 
       3.910861626005772, 50.}, {124.69220851487844`, -3.910861626005772, 
       50.}, {124.69220851487844`, -3.910861626005772, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, 3.910861626005772, -50.}, {124.69220851487844`, 
       3.910861626005772, 50.}, {124.69220851487844`, -3.910861626005772, 
       50.}, {124.69220851487844`, -3.910861626005772, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{124.69220851487844`, 3.910861626005772, -50.}, {
       122.2751631047092, 11.349762493488669`, -50.}, {122.2751631047092, 
       11.349762493488669`, 50.}, {124.69220851487844`, 3.910861626005772, 
       50.}, {124.69220851487844`, 3.910861626005772, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{124.69220851487844`, 3.910861626005772, -50.}, {
       122.2751631047092, 11.349762493488669`, -50.}, {122.2751631047092, 
       11.349762493488669`, 50.}, {124.69220851487844`, 3.910861626005772, 
       50.}, {124.69220851487844`, 3.910861626005772, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{122.2751631047092, 11.349762493488669`, -50.}, {
       117.67766952966369`, 17.677669529663685`, -50.}, {117.67766952966369`, 
       17.677669529663685`, 50.}, {122.2751631047092, 11.349762493488669`, 
       50.}, {122.2751631047092, 11.349762493488669`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{122.2751631047092, 11.349762493488669`, -50.}, {
       117.67766952966369`, 17.677669529663685`, -50.}, {117.67766952966369`, 
       17.677669529663685`, 50.}, {122.2751631047092, 11.349762493488669`, 
       50.}, {122.2751631047092, 11.349762493488669`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{117.67766952966369`, 17.677669529663685`, -50.}, {
       111.34976249348867`, 22.275163104709197`, -50.}, {111.34976249348867`, 
       22.275163104709197`, 50.}, {117.67766952966369`, 17.677669529663685`, 
       50.}, {117.67766952966369`, 17.677669529663685`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{117.67766952966369`, 17.677669529663685`, -50.}, {
       111.34976249348867`, 22.275163104709197`, -50.}, {111.34976249348867`, 
       22.275163104709197`, 50.}, {117.67766952966369`, 17.677669529663685`, 
       50.}, {117.67766952966369`, 17.677669529663685`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{111.34976249348867`, 22.275163104709197`, -50.}, {
       103.91086162600577`, 24.692208514878445`, -50.}, {103.91086162600577`, 
       24.692208514878445`, 50.}, {111.34976249348867`, 22.275163104709197`, 
       50.}, {111.34976249348867`, 22.275163104709197`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{111.34976249348867`, 22.275163104709197`, -50.}, {
       103.91086162600577`, 24.692208514878445`, -50.}, {103.91086162600577`, 
       24.692208514878445`, 50.}, {111.34976249348867`, 22.275163104709197`, 
       50.}, {111.34976249348867`, 22.275163104709197`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{103.91086162600577`, 24.692208514878445`, -50.}, {
       96.08913837399423, 24.692208514878445`, -50.}, {96.08913837399423, 
       24.692208514878445`, 50.}, {103.91086162600577`, 24.692208514878445`, 
       50.}, {103.91086162600577`, 24.692208514878445`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{103.91086162600577`, 24.692208514878445`, -50.}, {
       96.08913837399423, 24.692208514878445`, -50.}, {96.08913837399423, 
       24.692208514878445`, 50.}, {103.91086162600577`, 24.692208514878445`, 
       50.}, {103.91086162600577`, 24.692208514878445`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{96.08913837399423, 24.692208514878445`, -50.}, {
       88.65023750651133, 22.275163104709197`, -50.}, {88.65023750651133, 
       22.275163104709197`, 50.}, {96.08913837399423, 24.692208514878445`, 
       50.}, {96.08913837399423, 24.692208514878445`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{96.08913837399423, 24.692208514878445`, -50.}, {
       88.65023750651133, 22.275163104709197`, -50.}, {88.65023750651133, 
       22.275163104709197`, 50.}, {96.08913837399423, 24.692208514878445`, 
       50.}, {96.08913837399423, 24.692208514878445`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{88.65023750651133, 22.275163104709197`, -50.}, {
       82.32233047033631, 17.677669529663685`, -50.}, {82.32233047033631, 
       17.677669529663685`, 50.}, {88.65023750651133, 22.275163104709197`, 
       50.}, {88.65023750651133, 22.275163104709197`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{88.65023750651133, 22.275163104709197`, -50.}, {
       82.32233047033631, 17.677669529663685`, -50.}, {82.32233047033631, 
       17.677669529663685`, 50.}, {88.65023750651133, 22.275163104709197`, 
       50.}, {88.65023750651133, 22.275163104709197`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{82.32233047033631, 17.677669529663685`, -50.}, {
       77.7248368952908, 11.349762493488669`, -50.}, {77.7248368952908, 
       11.349762493488669`, 50.}, {82.32233047033631, 17.677669529663685`, 
       50.}, {82.32233047033631, 17.677669529663685`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{82.32233047033631, 17.677669529663685`, -50.}, {
       77.7248368952908, 11.349762493488669`, -50.}, {77.7248368952908, 
       11.349762493488669`, 50.}, {82.32233047033631, 17.677669529663685`, 
       50.}, {82.32233047033631, 17.677669529663685`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{77.7248368952908, 11.349762493488669`, -50.}, {
       75.30779148512156, 3.910861626005772, -50.}, {75.30779148512156, 
       3.910861626005772, 50.}, {77.7248368952908, 11.349762493488669`, 
       50.}, {77.7248368952908, 11.349762493488669`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{77.7248368952908, 11.349762493488669`, -50.}, {
       75.30779148512156, 3.910861626005772, -50.}, {75.30779148512156, 
       3.910861626005772, 50.}, {77.7248368952908, 11.349762493488669`, 
       50.}, {77.7248368952908, 11.349762493488669`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{75.30779148512156, 3.910861626005772, -50.}, {
       75.30779148512156, -3.910861626005772, -50.}, {
       75.30779148512156, -3.910861626005772, 50.}, {75.30779148512156, 
       3.910861626005772, 50.}, {75.30779148512156, 
       3.910861626005772, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{75.30779148512156, 3.910861626005772, -50.}, {
       75.30779148512156, -3.910861626005772, -50.}, {
       75.30779148512156, -3.910861626005772, 50.}, {75.30779148512156, 
       3.910861626005772, 50.}, {75.30779148512156, 
       3.910861626005772, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{75.30779148512156, -3.910861626005772, -50.}, {
       77.7248368952908, -11.349762493488669`, -50.}, {
       77.7248368952908, -11.349762493488669`, 50.}, {
       75.30779148512156, -3.910861626005772, 50.}, {
       75.30779148512156, -3.910861626005772, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{75.30779148512156, -3.910861626005772, -50.}, {
       77.7248368952908, -11.349762493488669`, -50.}, {
       77.7248368952908, -11.349762493488669`, 50.}, {
       75.30779148512156, -3.910861626005772, 50.}, {
       75.30779148512156, -3.910861626005772, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{77.7248368952908, -11.349762493488669`, -50.}, {
       82.32233047033631, -17.677669529663685`, -50.}, {
       82.32233047033631, -17.677669529663685`, 50.}, {
       77.7248368952908, -11.349762493488669`, 50.}, {
       77.7248368952908, -11.349762493488669`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{77.7248368952908, -11.349762493488669`, -50.}, {
       82.32233047033631, -17.677669529663685`, -50.}, {
       82.32233047033631, -17.677669529663685`, 50.}, {
       77.7248368952908, -11.349762493488669`, 50.}, {
       77.7248368952908, -11.349762493488669`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{82.32233047033631, -17.677669529663685`, -50.}, {
       88.65023750651133, -22.275163104709197`, -50.}, {
       88.65023750651133, -22.275163104709197`, 50.}, {
       82.32233047033631, -17.677669529663685`, 50.}, {
       82.32233047033631, -17.677669529663685`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{82.32233047033631, -17.677669529663685`, -50.}, {
       88.65023750651133, -22.275163104709197`, -50.}, {
       88.65023750651133, -22.275163104709197`, 50.}, {
       82.32233047033631, -17.677669529663685`, 50.}, {
       82.32233047033631, -17.677669529663685`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{88.65023750651133, -22.275163104709197`, -50.}, {
       96.08913837399423, -24.692208514878445`, -50.}, {
       96.08913837399423, -24.692208514878445`, 50.}, {
       88.65023750651133, -22.275163104709197`, 50.}, {
       88.65023750651133, -22.275163104709197`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{88.65023750651133, -22.275163104709197`, -50.}, {
       96.08913837399423, -24.692208514878445`, -50.}, {
       96.08913837399423, -24.692208514878445`, 50.}, {
       88.65023750651133, -22.275163104709197`, 50.}, {
       88.65023750651133, -22.275163104709197`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{96.08913837399423, -24.692208514878445`, -50.}, {
       103.91086162600577`, -24.692208514878445`, -50.}, {
       103.91086162600577`, -24.692208514878445`, 50.}, {
       96.08913837399423, -24.692208514878445`, 50.}, {
       96.08913837399423, -24.692208514878445`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{96.08913837399423, -24.692208514878445`, -50.}, {
       103.91086162600577`, -24.692208514878445`, -50.}, {
       103.91086162600577`, -24.692208514878445`, 50.}, {
       96.08913837399423, -24.692208514878445`, 50.}, {
       96.08913837399423, -24.692208514878445`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{103.91086162600577`, -24.692208514878445`, -50.}, {
       111.34976249348867`, -22.275163104709197`, -50.}, {
       111.34976249348867`, -22.275163104709197`, 50.}, {
       103.91086162600577`, -24.692208514878445`, 50.}, {
       103.91086162600577`, -24.692208514878445`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{103.91086162600577`, -24.692208514878445`, -50.}, {
       111.34976249348867`, -22.275163104709197`, -50.}, {
       111.34976249348867`, -22.275163104709197`, 50.}, {
       103.91086162600577`, -24.692208514878445`, 50.}, {
       103.91086162600577`, -24.692208514878445`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{111.34976249348867`, -22.275163104709197`, -50.}, {
       117.67766952966369`, -17.677669529663685`, -50.}, {
       117.67766952966369`, -17.677669529663685`, 50.}, {
       111.34976249348867`, -22.275163104709197`, 50.}, {
       111.34976249348867`, -22.275163104709197`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{111.34976249348867`, -22.275163104709197`, -50.}, {
       117.67766952966369`, -17.677669529663685`, -50.}, {
       117.67766952966369`, -17.677669529663685`, 50.}, {
       111.34976249348867`, -22.275163104709197`, 50.}, {
       111.34976249348867`, -22.275163104709197`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{117.67766952966369`, -17.677669529663685`, -50.}, {
       122.2751631047092, -11.349762493488669`, -50.}, {
       122.2751631047092, -11.349762493488669`, 50.}, {
       117.67766952966369`, -17.677669529663685`, 50.}, {
       117.67766952966369`, -17.677669529663685`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{117.67766952966369`, -17.677669529663685`, -50.}, {
       122.2751631047092, -11.349762493488669`, -50.}, {
       122.2751631047092, -11.349762493488669`, 50.}, {
       117.67766952966369`, -17.677669529663685`, 50.}, {
       117.67766952966369`, -17.677669529663685`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{122.2751631047092, -11.349762493488669`, -50.}, {
       124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, -3.910861626005772, 50.}, {
       122.2751631047092, -11.349762493488669`, 50.}, {
       122.2751631047092, -11.349762493488669`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{122.2751631047092, -11.349762493488669`, -50.}, {
       124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, -3.910861626005772, 50.}, {
       122.2751631047092, -11.349762493488669`, 50.}, {
       122.2751631047092, -11.349762493488669`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, 3.910861626005772, -50.}, {124.69220851487844`, 
       3.910861626005772, 50.}, {124.69220851487844`, -3.910861626005772, 
       50.}, {124.69220851487844`, -3.910861626005772, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{124.69220851487844`, -3.910861626005772, -50.}, {
       124.69220851487844`, 3.910861626005772, -50.}, {124.69220851487844`, 
       3.910861626005772, 50.}, {124.69220851487844`, -3.910861626005772, 
       50.}, {124.69220851487844`, -3.910861626005772, -50.}}]}}, {
     {GrayLevel[0.9], 
      Polygon3DBox[{{114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, 2.346516975603463, -50.}, {114.81532510892707`, 
       2.346516975603463, 50.}, {114.81532510892707`, -2.346516975603463, 
       50.}, {114.81532510892707`, -2.346516975603463, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, 2.346516975603463, -50.}, {114.81532510892707`, 
       2.346516975603463, 50.}, {114.81532510892707`, -2.346516975603463, 
       50.}, {114.81532510892707`, -2.346516975603463, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{114.81532510892707`, 2.346516975603463, -50.}, {
       113.36509786282552`, 6.809857496093201, -50.}, {113.36509786282552`, 
       6.809857496093201, 50.}, {114.81532510892707`, 2.346516975603463, 
       50.}, {114.81532510892707`, 2.346516975603463, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{114.81532510892707`, 2.346516975603463, -50.}, {
       113.36509786282552`, 6.809857496093201, -50.}, {113.36509786282552`, 
       6.809857496093201, 50.}, {114.81532510892707`, 2.346516975603463, 
       50.}, {114.81532510892707`, 2.346516975603463, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{113.36509786282552`, 6.809857496093201, -50.}, {
       110.60660171779821`, 10.606601717798211`, -50.}, {110.60660171779821`, 
       10.606601717798211`, 50.}, {113.36509786282552`, 6.809857496093201, 
       50.}, {113.36509786282552`, 6.809857496093201, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{113.36509786282552`, 6.809857496093201, -50.}, {
       110.60660171779821`, 10.606601717798211`, -50.}, {110.60660171779821`, 
       10.606601717798211`, 50.}, {113.36509786282552`, 6.809857496093201, 
       50.}, {113.36509786282552`, 6.809857496093201, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{110.60660171779821`, 10.606601717798211`, -50.}, {
       106.8098574960932, 13.365097862825518`, -50.}, {106.8098574960932, 
       13.365097862825518`, 50.}, {110.60660171779821`, 10.606601717798211`, 
       50.}, {110.60660171779821`, 10.606601717798211`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{110.60660171779821`, 10.606601717798211`, -50.}, {
       106.8098574960932, 13.365097862825518`, -50.}, {106.8098574960932, 
       13.365097862825518`, 50.}, {110.60660171779821`, 10.606601717798211`, 
       50.}, {110.60660171779821`, 10.606601717798211`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{106.8098574960932, 13.365097862825518`, -50.}, {
       102.34651697560346`, 14.815325108927066`, -50.}, {102.34651697560346`, 
       14.815325108927066`, 50.}, {106.8098574960932, 13.365097862825518`, 
       50.}, {106.8098574960932, 13.365097862825518`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{106.8098574960932, 13.365097862825518`, -50.}, {
       102.34651697560346`, 14.815325108927066`, -50.}, {102.34651697560346`, 
       14.815325108927066`, 50.}, {106.8098574960932, 13.365097862825518`, 
       50.}, {106.8098574960932, 13.365097862825518`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{102.34651697560346`, 14.815325108927066`, -50.}, {
       97.65348302439654, 14.815325108927066`, -50.}, {97.65348302439654, 
       14.815325108927066`, 50.}, {102.34651697560346`, 14.815325108927066`, 
       50.}, {102.34651697560346`, 14.815325108927066`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{102.34651697560346`, 14.815325108927066`, -50.}, {
       97.65348302439654, 14.815325108927066`, -50.}, {97.65348302439654, 
       14.815325108927066`, 50.}, {102.34651697560346`, 14.815325108927066`, 
       50.}, {102.34651697560346`, 14.815325108927066`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{97.65348302439654, 14.815325108927066`, -50.}, {
       93.1901425039068, 13.365097862825518`, -50.}, {93.1901425039068, 
       13.365097862825518`, 50.}, {97.65348302439654, 14.815325108927066`, 
       50.}, {97.65348302439654, 14.815325108927066`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{97.65348302439654, 14.815325108927066`, -50.}, {
       93.1901425039068, 13.365097862825518`, -50.}, {93.1901425039068, 
       13.365097862825518`, 50.}, {97.65348302439654, 14.815325108927066`, 
       50.}, {97.65348302439654, 14.815325108927066`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{93.1901425039068, 13.365097862825518`, -50.}, {
       89.39339828220179, 10.606601717798211`, -50.}, {89.39339828220179, 
       10.606601717798211`, 50.}, {93.1901425039068, 13.365097862825518`, 
       50.}, {93.1901425039068, 13.365097862825518`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{93.1901425039068, 13.365097862825518`, -50.}, {
       89.39339828220179, 10.606601717798211`, -50.}, {89.39339828220179, 
       10.606601717798211`, 50.}, {93.1901425039068, 13.365097862825518`, 
       50.}, {93.1901425039068, 13.365097862825518`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{89.39339828220179, 10.606601717798211`, -50.}, {
       86.63490213717448, 6.809857496093201, -50.}, {86.63490213717448, 
       6.809857496093201, 50.}, {89.39339828220179, 10.606601717798211`, 
       50.}, {89.39339828220179, 10.606601717798211`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{89.39339828220179, 10.606601717798211`, -50.}, {
       86.63490213717448, 6.809857496093201, -50.}, {86.63490213717448, 
       6.809857496093201, 50.}, {89.39339828220179, 10.606601717798211`, 
       50.}, {89.39339828220179, 10.606601717798211`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{86.63490213717448, 6.809857496093201, -50.}, {
       85.18467489107293, 2.346516975603463, -50.}, {85.18467489107293, 
       2.346516975603463, 50.}, {86.63490213717448, 6.809857496093201, 50.}, {
       86.63490213717448, 6.809857496093201, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{86.63490213717448, 6.809857496093201, -50.}, {
       85.18467489107293, 2.346516975603463, -50.}, {85.18467489107293, 
       2.346516975603463, 50.}, {86.63490213717448, 6.809857496093201, 50.}, {
       86.63490213717448, 6.809857496093201, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{85.18467489107293, 2.346516975603463, -50.}, {
       85.18467489107293, -2.346516975603463, -50.}, {
       85.18467489107293, -2.346516975603463, 50.}, {85.18467489107293, 
       2.346516975603463, 50.}, {85.18467489107293, 
       2.346516975603463, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{85.18467489107293, 2.346516975603463, -50.}, {
       85.18467489107293, -2.346516975603463, -50.}, {
       85.18467489107293, -2.346516975603463, 50.}, {85.18467489107293, 
       2.346516975603463, 50.}, {85.18467489107293, 
       2.346516975603463, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{85.18467489107293, -2.346516975603463, -50.}, {
       86.63490213717448, -6.809857496093201, -50.}, {
       86.63490213717448, -6.809857496093201, 50.}, {
       85.18467489107293, -2.346516975603463, 50.}, {
       85.18467489107293, -2.346516975603463, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{85.18467489107293, -2.346516975603463, -50.}, {
       86.63490213717448, -6.809857496093201, -50.}, {
       86.63490213717448, -6.809857496093201, 50.}, {
       85.18467489107293, -2.346516975603463, 50.}, {
       85.18467489107293, -2.346516975603463, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{86.63490213717448, -6.809857496093201, -50.}, {
       89.39339828220179, -10.606601717798211`, -50.}, {
       89.39339828220179, -10.606601717798211`, 50.}, {
       86.63490213717448, -6.809857496093201, 50.}, {
       86.63490213717448, -6.809857496093201, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{86.63490213717448, -6.809857496093201, -50.}, {
       89.39339828220179, -10.606601717798211`, -50.}, {
       89.39339828220179, -10.606601717798211`, 50.}, {
       86.63490213717448, -6.809857496093201, 50.}, {
       86.63490213717448, -6.809857496093201, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{89.39339828220179, -10.606601717798211`, -50.}, {
       93.1901425039068, -13.365097862825518`, -50.}, {
       93.1901425039068, -13.365097862825518`, 50.}, {
       89.39339828220179, -10.606601717798211`, 50.}, {
       89.39339828220179, -10.606601717798211`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{89.39339828220179, -10.606601717798211`, -50.}, {
       93.1901425039068, -13.365097862825518`, -50.}, {
       93.1901425039068, -13.365097862825518`, 50.}, {
       89.39339828220179, -10.606601717798211`, 50.}, {
       89.39339828220179, -10.606601717798211`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{93.1901425039068, -13.365097862825518`, -50.}, {
       97.65348302439654, -14.815325108927066`, -50.}, {
       97.65348302439654, -14.815325108927066`, 50.}, {
       93.1901425039068, -13.365097862825518`, 50.}, {
       93.1901425039068, -13.365097862825518`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{93.1901425039068, -13.365097862825518`, -50.}, {
       97.65348302439654, -14.815325108927066`, -50.}, {
       97.65348302439654, -14.815325108927066`, 50.}, {
       93.1901425039068, -13.365097862825518`, 50.}, {
       93.1901425039068, -13.365097862825518`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{97.65348302439654, -14.815325108927066`, -50.}, {
       102.34651697560346`, -14.815325108927066`, -50.}, {
       102.34651697560346`, -14.815325108927066`, 50.}, {
       97.65348302439654, -14.815325108927066`, 50.}, {
       97.65348302439654, -14.815325108927066`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{97.65348302439654, -14.815325108927066`, -50.}, {
       102.34651697560346`, -14.815325108927066`, -50.}, {
       102.34651697560346`, -14.815325108927066`, 50.}, {
       97.65348302439654, -14.815325108927066`, 50.}, {
       97.65348302439654, -14.815325108927066`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{102.34651697560346`, -14.815325108927066`, -50.}, {
       106.8098574960932, -13.365097862825518`, -50.}, {
       106.8098574960932, -13.365097862825518`, 50.}, {
       102.34651697560346`, -14.815325108927066`, 50.}, {
       102.34651697560346`, -14.815325108927066`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{102.34651697560346`, -14.815325108927066`, -50.}, {
       106.8098574960932, -13.365097862825518`, -50.}, {
       106.8098574960932, -13.365097862825518`, 50.}, {
       102.34651697560346`, -14.815325108927066`, 50.}, {
       102.34651697560346`, -14.815325108927066`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{106.8098574960932, -13.365097862825518`, -50.}, {
       110.60660171779821`, -10.606601717798211`, -50.}, {
       110.60660171779821`, -10.606601717798211`, 50.}, {
       106.8098574960932, -13.365097862825518`, 50.}, {
       106.8098574960932, -13.365097862825518`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{106.8098574960932, -13.365097862825518`, -50.}, {
       110.60660171779821`, -10.606601717798211`, -50.}, {
       110.60660171779821`, -10.606601717798211`, 50.}, {
       106.8098574960932, -13.365097862825518`, 50.}, {
       106.8098574960932, -13.365097862825518`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{110.60660171779821`, -10.606601717798211`, -50.}, {
       113.36509786282552`, -6.809857496093201, -50.}, {
       113.36509786282552`, -6.809857496093201, 50.}, {
       110.60660171779821`, -10.606601717798211`, 50.}, {
       110.60660171779821`, -10.606601717798211`, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{110.60660171779821`, -10.606601717798211`, -50.}, {
       113.36509786282552`, -6.809857496093201, -50.}, {
       113.36509786282552`, -6.809857496093201, 50.}, {
       110.60660171779821`, -10.606601717798211`, 50.}, {
       110.60660171779821`, -10.606601717798211`, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{113.36509786282552`, -6.809857496093201, -50.}, {
       114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, -2.346516975603463, 50.}, {
       113.36509786282552`, -6.809857496093201, 50.}, {
       113.36509786282552`, -6.809857496093201, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{113.36509786282552`, -6.809857496093201, -50.}, {
       114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, -2.346516975603463, 50.}, {
       113.36509786282552`, -6.809857496093201, 50.}, {
       113.36509786282552`, -6.809857496093201, -50.}}]}, 
     {GrayLevel[0.9], 
      Polygon3DBox[{{114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, 2.346516975603463, -50.}, {114.81532510892707`, 
       2.346516975603463, 50.}, {114.81532510892707`, -2.346516975603463, 
       50.}, {114.81532510892707`, -2.346516975603463, -50.}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{114.81532510892707`, -2.346516975603463, -50.}, {
       114.81532510892707`, 2.346516975603463, -50.}, {114.81532510892707`, 
       2.346516975603463, 50.}, {114.81532510892707`, -2.346516975603463, 
       50.}, {114.81532510892707`, -2.346516975603463, -50.}}]}}, 
    {Hue[0.8], Point3DBox[{0., -100., -100}], Point3DBox[{0., -100., 100}], 
     Line3DBox[{{0., -100., 0}, {200., -100., 0}}], 
     Line3DBox[{{200., -100., 0}, {200., 100., 0}}], 
     Line3DBox[{{200., 100., 0}, {0., 100., 0}}], 
     Line3DBox[{{0., -100., 0}, {0., 100., 0}}]}}, 
   {Thickness[0.0005], {{
      {Hue[0.3], 
       Line3DBox[{{71.7157287525381, -98.99494936611666, 0}, {
         135.35533905932738`, -35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{135.35533905932738`, -35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{135.35533905932738`, -35.35533905932738, 0.}, {200., 
        29.28932188134523, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{200., 29.28932188134523, 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{63.858986739354236`, -91.1382073529328, 0}, {
         119.64185503295965`, -35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{119.64185503295965`, -35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{119.64185503295965`, -35.35533905932738, 0.}, {
        135.35533905932738`, -19.641855032959654`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{135.35533905932738`, -19.641855032959654`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{135.35533905932738`, -19.641855032959654`, 0.}, {200., 
        45.002805907712954`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{200., 45.002805907712954`, 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{56.002244726170375`, -83.28146533974893, 0}, {
         103.92837100659193`, -35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{103.92837100659193`, -35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{103.92837100659193`, -35.35533905932738, 0.}, {
        135.35533905932738`, -3.9283710065919344`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{135.35533905932738`, -3.9283710065919344`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{135.35533905932738`, -3.9283710065919344`, 0.}, {200., 
        60.71628993408068, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{200., 60.71628993408068, 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{48.14550271298651, -75.42472332656507, 0}, {
         88.21488698022421, -35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{88.21488698022421, -35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{88.21488698022421, -35.35533905932738, 0.}, {
        98.87801752467314, -24.692208514878445`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{98.87801752467314, -24.692208514878445`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{98.87801752467314, -24.692208514878445`, 0.}, {
        124.69220851487844`, 1.1219824753268561`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{124.69220851487844`, 1.1219824753268561`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{124.69220851487844`, 1.1219824753268561`, 0.}, {
        135.35533905932738`, 11.785113019775787`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{135.35533905932738`, 11.785113019775787`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{135.35533905932738`, 11.785113019775787`, 0.}, {200., 
        76.4297739604484, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{200., 76.4297739604484, 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{40.28876069980265, -67.56798131338121, 0}, {
         86.87289432019446, -20.983847692989414`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{86.87289432019446, -20.983847692989414`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{86.87289432019446, -20.983847692989414`, 0.}, {
        94.17246743284556, -13.684274580338315`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{94.17246743284556, -13.684274580338315`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{94.17246743284556, -13.684274580338315`, 0.}, {
        113.68427458033833`, 5.827532567154435, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{113.68427458033833`, 5.827532567154435, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{113.68427458033833`, 5.827532567154435, 0.}, {
        120.98384769298944`, 13.127105679805545`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{120.98384769298944`, 13.127105679805545`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{120.98384769298944`, 13.127105679805545`, 0.}, {
        135.35533905932738`, 27.49859704614348, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{135.35533905932738`, 27.49859704614348, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{135.35533905932738`, 27.49859704614348, 0.}, {200., 
        92.14325798681608, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{200., 92.14325798681608, 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{32.43201868661879, -59.71123930019735, 0}, {
         79.01615230701057, -13.127105679805567`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{79.01615230701057, -13.127105679805567`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{79.01615230701057, -13.127105679805567`, 0.}, {
        86.31572541966169, -5.827532567154451, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{86.31572541966169, -5.827532567154451, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{86.31572541966169, -5.827532567154451, 0.}, {
        105.82753256715446`, 13.684274580338313`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{105.82753256715446`, 13.684274580338313`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{105.82753256715446`, 13.684274580338313`, 0.}, {
        113.12710567980557`, 20.983847692989414`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{113.12710567980557`, 20.983847692989414`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{113.12710567980557`, 20.983847692989414`, 0.}, {
        127.49859704614353`, 35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{127.49859704614353`, 35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{127.49859704614353`, 35.35533905932738, 0.}, {
        192.14325798681617`, 100., 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{192.14325798681617`, 100., 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{24.575276673434928`, -51.85449728701349, 0}, {
         64.64466094067262, -11.7851130197758, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{64.64466094067262, -11.7851130197758, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{64.64466094067262, -11.7851130197758, 0.}, {
        75.30779148512156, -1.1219824753268686`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{75.30779148512156, -1.1219824753268686`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{75.30779148512156, -1.1219824753268686`, 0.}, {
        101.12198247532687`, 24.692208514878445`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{101.12198247532687`, 24.692208514878445`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{101.12198247532687`, 24.692208514878445`, 0.}, {
        111.7851130197758, 35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{111.7851130197758, 35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{111.7851130197758, 35.35533905932738, 0.}, {
        176.42977396044844`, 100., 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{176.42977396044844`, 100., 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{16.718534660251066`, -43.997755273829625`, 0}, {
         64.64466094067262, 3.9283710065919237`, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{64.64466094067262, 3.9283710065919237`, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{64.64466094067262, 3.9283710065919237`, 0.}, {
        96.07162899340808, 35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{96.07162899340808, 35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{96.07162899340808, 35.35533905932738, 0.}, {
        160.71628993408072`, 100., 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{160.71628993408072`, 100., 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{8.861792647067205, -36.14101326064577, 0}, {
         64.64466094067262, 19.64185503295964, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{64.64466094067262, 19.64185503295964, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{64.64466094067262, 19.64185503295964, 0.}, {
        80.35814496704036, 35.35533905932738, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{80.35814496704036, 35.35533905932738, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{80.35814496704036, 35.35533905932738, 0.}, {
        145.002805907713, 100., 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{145.002805907713, 100., 0.}]}}}, {{
      {Hue[0.3], 
       Line3DBox[{{1.005050633883343, -28.28427124746191, 0}, {
         64.64466094067262, 35.35533905932736, 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{64.64466094067262, 35.35533905932736, 0.}]}}, {
      {Hue[0.3], 
       Line3DBox[{{64.64466094067262, 35.35533905932736, 0.}, {
        129.28932188134524`, 100., 0.}}]}, 
      {Hue[1], AbsolutePointSize[5], 
       Point3DBox[{129.28932188134524`, 100., 0.}]}}}}},
  AspectRatio->Automatic,
  ImageSize->{190.254629582465, 192.},
  PlotRange->All,
  ViewPoint->{0.26852165736913725`, -0.09110327615465286, 3.3718831997264718`},
  ViewVertical->{-0.3068018391566176, 0.6868206768476949, 
   0.6589005913979675}]], "Output",
 CellChangeTimes->{{3.521981933460148*^9, 3.5219819564233475`*^9}, {
   3.5219819944093475`*^9, 3.5219820156253476`*^9}, {3.5219825081017475`*^9, 
   3.5219825409241476`*^9}, 3.521990963847748*^9, 3.5219957584921474`*^9, 
   3.5219962353373475`*^9, 3.521996278689748*^9, 3.5219963587177477`*^9, {
   3.5219964838453474`*^9, 3.5219965547317476`*^9}, {3.5219966014537477`*^9, 
   3.5219966157121477`*^9}, 3.5219966519977474`*^9, 3.521996688564148*^9, 
   3.521996731261348*^9, 3.521996831896948*^9, 3.5219969218153477`*^9, 
   3.5219969564785476`*^9, 3.5219970071629477`*^9, 3.5219974439785476`*^9, 
   3.5219975372197475`*^9, 3.5219976325513477`*^9, 3.5219977174309473`*^9, 
   3.5220448043929477`*^9, 3.522044952655348*^9, 3.5220453098173475`*^9, 
   3.5220463669045477`*^9, 3.5220469077097473`*^9, 3.5220646503853474`*^9, 
   3.522064827445348*^9, 3.5220648825601473`*^9, 3.522064941606148*^9, {
   3.522064989123748*^9, 3.5220649942561474`*^9}, 3.522065081319748*^9, {
   3.522065168336548*^9, 3.522065174233348*^9}, 3.5220659068405476`*^9, 
   3.5220660053545475`*^9, 3.5220661213873477`*^9, 3.5220665073781476`*^9, 
   3.5220696258493476`*^9, 3.5220699965209475`*^9, 3.522070456330948*^9, 
   3.5220705768721476`*^9, 3.5220706232821474`*^9, 3.5220708746761475`*^9, 
   3.5220709569037476`*^9, 3.522071113574548*^9, 3.5220711719965477`*^9, 
   3.5220714225481477`*^9, 3.5220730863817472`*^9, 3.5220837320713477`*^9, 
   3.5221475924983025`*^9, 3.5221480462272115`*^9, 3.522150650913508*^9, 
   3.5221507586009984`*^9, 3.5221507957448363`*^9, 3.522151729691623*^9, 
   3.5221519496530333`*^9, 3.522152341823947*^9, 3.5221549319397507`*^9, {
   3.522154961985543*^9, 3.522155013824675*^9}, 3.5221550580353584`*^9, 
   3.522155737482114*^9, 3.522156395463132*^9, 3.522156490826543*^9, 
   3.522159474813671*^9, 3.522159757175481*^9, 3.5221604905673823`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"system", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"definition", " ", "--"}], "--"}], "--"}], "--"}],
                     "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MySystem", "[", "direct_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"CenteredParallelRays", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"direct", ",", " ", "0"}], "}"}], ",", " ", "100", ",", 
            "90", ",", 
            RowBox[{"NumberOfRays", "\[Rule]", "10"}]}], "]"}], " ", "}"}], 
         ",", "\n", "\t", 
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{"Place", "[", 
            RowBox[{
             RowBox[{"PolygonalNode", "[", 
              RowBox[{"4", ",", "100", ",", "100"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NodeType", "\[Rule]", "Moderator"}], ",", 
               RowBox[{"NodeID", "\[Rule]", " ", "IDm1"}]}], "}"}]}], "]"}], 
           ",", "   ", "\[IndentingNewLine]", "       ", 
           RowBox[{"Place", "[", 
            RowBox[{
             RowBox[{"PolygonalNode", "[", 
              RowBox[{"20", ",", "50", ",", "100"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NodeType", "\[Rule]", " ", "Fuel"}], ",", 
               RowBox[{"NodeID", "\[Rule]", " ", "IDf1"}]}], "}"}]}], "]"}], 
           " ", ",", " ", "\[IndentingNewLine]", "      ", 
           RowBox[{"Place", "[", 
            RowBox[{
             RowBox[{"PolygonalNode", "[", 
              RowBox[{"20", ",", "30", ",", "100"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NodeType", "\[Rule]", " ", "Fuel"}], ",", 
               RowBox[{"NodeID", "->", "IDf2"}]}], "}"}]}], "]"}], " ", ",", 
           "\n", "\t ", 
           RowBox[{"Boundary", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "100"}], ",", 
               RowBox[{"-", "100"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"200", ",", "100", ",", "100"}], "}"}]}], "]"}]}], " ", 
          "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "calculate", " ", "average", " ", "angular", " ", "flux", " ", "within", 
     " ", "a", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"region", "  ", "--"}], "--"}], "--"}], "--"}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CalcAverageAngularFlux", "[", 
      RowBox[{"trackstore_", ",", "phistore_", ",", "mat_", ",", "dir_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndirect", "=", 
          RowBox[{"Length", "[", "trackstore", "]"}]}], ",", 
         RowBox[{"nrays", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"trackstore", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "k", ",", "l", ",", 
         "j", ",", "wi", ",", "track", ",", "ids", ",", "ray1", ",", "ray2", 
         ",", "wo", ",", "sumL", ",", "sumP", ",", "fluss"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wo", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", "dir"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"initialize", " ", "direction"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sumP", "=", "0.0"}], ";", 
        RowBox[{"sumL", "=", "0.0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"l", "=", "0"}], ",", 
          RowBox[{"l", "<", "nrays"}], ",", 
          RowBox[{"l", "++"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "sum", " ", "over", " ", "number", " ", "of", " ", "tracks"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"track", "=", 
            RowBox[{
             RowBox[{"trackstore", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"l", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{
               RowBox[{"Length", "[", "track", "]"}], "-", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sum", " ", "over", " ", "number", " ", "of", " ", 
               "interaction", " ", "points", " ", "per", " ", "track"}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ids", "=", 
               RowBox[{"GetRayID", "[", 
                RowBox[{"track", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
              RowBox[{"ray1", "=", 
               RowBox[{"track", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
              RowBox[{"ray2", "=", 
               RowBox[{"track", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"wo", "=", 
               RowBox[{"CheckInside", "[", 
                RowBox[{"ray1", ",", "ray2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "wo", "]"}], "<>", "\"\< \>\"", "<>",
                   "ids", "<>", "\"\< \>\"", "<>", 
                  RowBox[{"GetRayID", "[", 
                   RowBox[{"track", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ids", "===", "mat"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"wo", ">", "0"}], ",", 
                   RowBox[{
                    RowBox[{"sumP", "=", 
                    RowBox[{"sumP", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/", "wo"}]}]}], ";", 
                    RowBox[{"sumL", "=", 
                    RowBox[{"sumL", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "/", "wo"}]}]}]}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"wo", "==", "0"}], ",", 
                   RowBox[{
                    RowBox[{"sumP", "=", 
                    RowBox[{"sumP", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "0"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ";", 
                    RowBox[{"sumL", "=", 
                    RowBox[{"sumL", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "0"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "]"}], ";"}]}], 
               " ", "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sumL", ">", "0"}], ",", 
          RowBox[{"fluss", "=", 
           RowBox[{"sumP", "/", "sumL"}]}], ",", 
          RowBox[{"fluss", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "fluss"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "calculate", " ", "average", " ", "flux", " ", "within", " ", "a", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"region", "  ", "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CalcAverageFlux", "[", 
      RowBox[{"trackstore_", ",", "phistore_", ",", "mat_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ndirect", "=", 
          RowBox[{"Length", "[", "trackstore", "]"}]}], ",", 
         RowBox[{"nrays", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"trackstore", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "k", ",", "l", ",", 
         "j", ",", "wi", ",", "track", ",", "ids", ",", "ray1", ",", "ray2", 
         ",", "wo", ",", "fluss", ",", "sumL", ",", "sumP"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wi", "=", 
         RowBox[{"1.0", "/", "ndirect"}]}], ";", 
        RowBox[{"wo", "=", "0"}], ";", 
        RowBox[{"fluss", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "<", "ndirect"}], ",", 
          RowBox[{"k", "++"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"sum", " ", "over", " ", "directions"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sumP", "=", "0.0"}], ";", 
           RowBox[{"sumL", "=", "0.0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"l", "=", "0"}], ",", 
             RowBox[{"l", "<", "nrays"}], ",", 
             RowBox[{"l", "++"}], ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sum", " ", "over", " ", "number", " ", "of", " ", "tracks"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"track", "=", 
               RowBox[{
                RowBox[{"trackstore", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"l", "+", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "0"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "track", "]"}], "-", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "sum", " ", "over", " ", "number", " ", "of", " ", 
                  "interaction", " ", "points", " ", "per", " ", "track"}], 
                 " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ids", "=", 
                  RowBox[{"GetRayID", "[", 
                   RowBox[{"track", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
                 RowBox[{"ray1", "=", 
                  RowBox[{"track", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
                 RowBox[{"ray2", "=", 
                  RowBox[{"track", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "2"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"wo", "=", 
                  RowBox[{"CheckInside", "[", 
                   RowBox[{"ray1", ",", "ray2"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ids", "===", "mat"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"wo", ">", "0"}], ",", 
                    RowBox[{
                    RowBox[{"sumP", "=", 
                    RowBox[{"sumP", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/", "wo"}]}]}], ";", 
                    RowBox[{"sumL", "=", 
                    RowBox[{"sumL", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "/", "wo"}]}]}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"wo", "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"sumP", "=", 
                    RowBox[{"sumP", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "0"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ";", 
                    RowBox[{"sumL", "=", 
                    RowBox[{"sumL", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phistore", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "0"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"fluss", "=", 
            RowBox[{"fluss", "+", 
             RowBox[{"wi", "*", 
              RowBox[{"sumP", "/", "sumL"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "fluss"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"do", " ", "one", " ", "global", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"iterations", "  ", "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}]}], "-", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"iter", "=", "0"}], ",", 
      RowBox[{"iter", "<", "1"}], ",", 
      RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrackStore", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"PhiStore", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"calculate", " ", "flux", " ", "on", " ", "all", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"segments", "  ", "--"}], "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"w", "=", "0"}], ",", 
         RowBox[{"w", "<", "8"}], ",", 
         RowBox[{"w", "++"}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{
          "do", " ", "8", " ", "directions", " ", "in", " ", "steps", " ", 
           "of", " ", "45", " ", "degrees"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TempStore", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mocs", "=", 
           RowBox[{"TrackSystem", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MySystem", "[", 
               RowBox[{"0", "+", 
                RowBox[{"45", "*", "w"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"MySystem", "[", 
               RowBox[{"0", "+", 
                RowBox[{"45", "*", "w"}]}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TrackStore", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"TrackStore", ",", "mocs"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"v", "=", "0"}], ",", 
            RowBox[{"v", "<", 
             RowBox[{"Length", "[", "mocs", "]"}]}], ",", 
            RowBox[{"v", "++"}], ",", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "integrate", " ", "angular", " ", "flux", " ", "along", " ", 
              "each", " ", "segment", " ", "of", " ", "a", " ", "track"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ints", "=", 
              RowBox[{"IntegrateAngularFlux", "[", 
               RowBox[{
                RowBox[{"mocs", "[", 
                 RowBox[{"[", 
                  RowBox[{"v", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"w", "+", "1"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TempStore", "=", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"TempStore", ",", "ints"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PhiStore", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"PhiStore", ",", "TempStore"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"update", " ", "global", " ", "angular", " ", "flux", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"store", " ", "--"}], "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"w", "=", "0"}], ",", 
         RowBox[{"w", "<", "8"}], ",", 
         RowBox[{"w", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GlobalAngularFluxStore", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"w", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"CalcAverageAngularFlux", "[", 
            RowBox[{"TrackStore", ",", "PhiStore", ",", "IDm1", ",", 
             RowBox[{"w", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"GlobalAngularFluxStore", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"w", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"CalcAverageAngularFlux", "[", 
            RowBox[{"TrackStore", ",", "PhiStore", ",", "IDf1", ",", 
             RowBox[{"w", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"GlobalAngularFluxStore", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"w", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"CalcAverageAngularFlux", "[", 
            RowBox[{"TrackStore", ",", "PhiStore", ",", "IDf2", ",", 
             RowBox[{"w", "+", "1"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", "GlobalAngularFluxStore", "]"}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"update", " ", "global", " ", "average", " ", "flux", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"store", " ", "--"}], "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GlobalAverageFluxStore", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"CalcAverageFlux", "[", 
         RowBox[{"TrackStore", ",", "PhiStore", ",", "IDm1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GlobalAverageFluxStore", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"CalcAverageFlux", "[", 
         RowBox[{"TrackStore", ",", "PhiStore", ",", "IDf1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GlobalAverageFluxStore", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"CalcAverageFlux", "[", 
         RowBox[{"TrackStore", ",", "PhiStore", ",", "IDf2"}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", "GlobalAverageFluxStore", "]"}], ";"}], " ", 
      "*)"}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "GlobalAverageFluxStore", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.522044845186948*^9, 3.5220448809265475`*^9}, 
   3.522045048564148*^9, 3.522045446052148*^9, {3.5220454828993473`*^9, 
   3.522045501634948*^9}, {3.5220455581225476`*^9, 3.522045558247348*^9}, {
   3.522045688569748*^9, 3.5220456990841475`*^9}, {3.5220647590861473`*^9, 
   3.5220647779465475`*^9}, {3.5220717281053476`*^9, 
   3.5220717282145476`*^9}, {3.5220717960589476`*^9, 
   3.5220719036053476`*^9}, {3.5220719645077477`*^9, 
   3.5220719975797477`*^9}, {3.5220720453781476`*^9, 
   3.5220720472033477`*^9}, {3.5220720875917473`*^9, 
   3.5220721735165477`*^9}, {3.5220724405573473`*^9, 3.522072467670148*^9}, {
   3.522072500414548*^9, 3.5220725031289473`*^9}, {3.5220725390089474`*^9, 
   3.5220726080857477`*^9}, {3.5220727655209475`*^9, 
   3.5220728189041476`*^9}, {3.522072994887748*^9, 3.5220730188025475`*^9}, {
   3.5220818765917473`*^9, 3.522081922549348*^9}, {3.522082035696148*^9, 
   3.5220820664905477`*^9}, {3.5220822560929475`*^9, 
   3.5220822586045475`*^9}, {3.5220824456641474`*^9, 
   3.5220825610885477`*^9}, {3.5220826597897477`*^9, 
   3.5220827389441476`*^9}, {3.5220827873665476`*^9, 
   3.5220827928265476`*^9}, {3.5220831464317474`*^9, 
   3.5220831542629476`*^9}, {3.5220832069129477`*^9, 
   3.5220832329181476`*^9}, {3.5220833435533476`*^9, 3.522083361836548*^9}, {
   3.522083537196148*^9, 3.522083661762148*^9}, {3.5220837510565476`*^9, 
   3.5220838679005475`*^9}, {3.5220846226753473`*^9, 
   3.5220846232369475`*^9}, {3.522133773586521*^9, 3.5221338304956856`*^9}, {
   3.5221343195276203`*^9, 3.5221343729735627`*^9}, 3.522134426996709*^9, {
   3.522134505434012*^9, 3.5221345059800158`*^9}, {3.52213456750681*^9, 
   3.5221345934653764`*^9}, {3.5221346987816515`*^9, 
   3.5221347269242315`*^9}, {3.5221347830689917`*^9, 
   3.5221347938174605`*^9}, {3.5221350815301046`*^9, 
   3.5221350825597115`*^9}, {3.522135435574374*^9, 3.5221354374463863`*^9}, {
   3.522135507693637*^9, 3.522135534525809*^9}, {3.5221430775797615`*^9, 
   3.522143107797155*^9}, {3.522143144160988*^9, 3.5221431532402463`*^9}, {
   3.522143628185291*^9, 3.5221436372177486`*^9}, 3.5221443988926315`*^9, {
   3.522144803340824*^9, 3.522144873572474*^9}, {3.5221449393580956`*^9, 
   3.5221450070469294`*^9}, {3.522145128306507*^9, 3.5221452083974204`*^9}, {
   3.5221458583755865`*^9, 3.5221458614176064`*^9}, {3.5221462684866157`*^9, 
   3.5221462855843253`*^9}, {3.5221464426773324`*^9, 3.522146448028167*^9}, {
   3.522146501910912*^9, 3.522146505951338*^9}, {3.5221465420655694`*^9, 
   3.522146712793064*^9}, {3.5221467615433764`*^9, 3.522146842726297*^9}, {
   3.5221475605960984`*^9, 3.5221475658845325`*^9}, {3.5221476376761923`*^9, 
   3.522147661341544*^9}, {3.522147810743702*^9, 3.5221478124285126`*^9}, {
   3.5221484442793627`*^9, 3.522148472328343*^9}, {3.5221523653020973`*^9, 
   3.522152367361311*^9}, {3.5221524024771357`*^9, 3.5221524026175365`*^9}, {
   3.522152436828556*^9, 3.5221524897128954`*^9}, {3.5221526402382603`*^9, 
   3.5221526679440374`*^9}, {3.5221526988322353`*^9, 3.522152777659541*^9}, {
   3.5221528215738225`*^9, 3.522152831947889*^9}, {3.5221529128344073`*^9, 
   3.5221529320693307`*^9}, {3.5221529873560853`*^9, 
   3.5221530100386305`*^9}, {3.522153064670181*^9, 3.5221530808474846`*^9}, {
   3.5221531168057146`*^9, 3.522153119956935*^9}, {3.5221535872579308`*^9, 
   3.52215359649319*^9}, {3.522153645976707*^9, 3.5221536906553936`*^9}, {
   3.5221539426282086`*^9, 3.522153953563879*^9}, {3.5221543843606405`*^9, 
   3.522154410958811*^9}, {3.5221545726382475`*^9, 3.522154579736293*^9}, {
   3.522154657471591*^9, 3.522154669670869*^9}, 3.5221548500860257`*^9, {
   3.522155110670096*^9, 3.522155203537491*^9}, 3.5221552829732003`*^9, {
   3.522155351083237*^9, 3.5221553996775484`*^9}, {3.5221556467831326`*^9, 
   3.522155720961608*^9}, {3.5221557579962454`*^9, 3.5221557712563305`*^9}, {
   3.5221559990177903`*^9, 3.5221560015294065`*^9}, {3.5221562907084603`*^9, 
   3.5221563517204514`*^9}, {3.522156414822856*^9, 3.5221564180832767`*^9}, 
   3.52215651377429*^9, {3.522156639074293*^9, 3.522156639355095*^9}, 
   3.522156694423448*^9, {3.5221570729910746`*^9, 3.522157098325637*^9}, {
   3.5221571403211064`*^9, 3.522157147403552*^9}, 3.522157420623703*^9, {
   3.522158403258402*^9, 3.522158408624837*^9}, {3.5221585442521057`*^9, 
   3.522158665917286*^9}, {3.5221586961970797`*^9, 3.5221587015947146`*^9}, {
   3.522159234868533*^9, 3.522159245601402*^9}, 3.5221594688700333`*^9, {
   3.522160567897078*^9, 3.5221605884268093`*^9}, {3.5221606690169263`*^9, 
   3.5221606703429346`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.2506177367118324`", ",", "0.41778839103485055`", ",", 
   "0.6468403992957303`"}], "}"}]], "Print",
 CellChangeTimes->{3.5221606963171015`*^9}]
}, Open  ]]
},
WindowSize->{1082, 660},
WindowMargins->{{Automatic, 84}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 142706, 3576, 6652, "Input"],
Cell[143288, 3600, 41052, 743, 207, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184377, 4348, 40810, 1006, 1812, "Input"],
Cell[225190, 5356, 188, 5, 23, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
